<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 31.0.9">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
pre.idl{padding:1em;position:relative}
pre.idl>code{color:#000}
@media print{
pre.idl{white-space:pre-wrap}
}
.idlHeader{display:block;width:150px;background:#8ccbf2;color:#fff;font-family:sans-serif;font-weight:700;margin:-1em 0 1em -1em;height:28px;line-height:28px}
.idlHeader a.self-link{margin-left:.3cm;text-decoration:none;border-bottom:none}
.idlID{font-weight:700;color:#005a9c}
.idlType{color:#005a9c}
.idlName{color:#ff4500}
.idlName a{color:#ff4500;border-bottom:1px dotted #ff4500;text-decoration:none}
a.idlEnumItem{color:#000;border-bottom:1px dotted #ccc;text-decoration:none}
.idlSuperclass{font-style:italic;color:#005a9c}
.idlDefaultValue,.idlParamName{font-style:italic}
.extAttr{color:#666}
.idlSectionComment{color:gray}
.idlIncludes a{font-weight:700}
.respec-button-copy-paste:focus{text-decoration:none;border-color:#51a7e8;outline:0;box-shadow:0 0 5px rgba(81,167,232,.5)}
.respec-button-copy-paste:is(:focus:hover,.selected:focus){border-color:#51a7e8}
.respec-button-copy-paste:is(:hover,:active,.zeroclipboard-is-hover,.zeroclipboard-is-active){text-decoration:none;background-color:#ddd;background-image:linear-gradient(#eee,#ddd);border-color:#ccc}
.respec-button-copy-paste:is(:active,.selected,.zeroclipboard-is-active){background-color:#dcdcdc;background-image:none;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}
.respec-button-copy-paste.selected:hover{background-color:#cfcfcf}
.respec-button-copy-paste:is(:disabled,:disabled:hover,.disabled,.disabled:hover){color:rgba(102,102,102,.5);cursor:default;background-color:rgba(229,229,229,.5);background-image:none;border-color:rgba(197,197,197,.5);box-shadow:none}
@media print{
.respec-button-copy-paste{visibility:hidden}
}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font:small Helvetica Neue,sans-serif,Droid Sans Fallback;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
    
<title>Permissions</title>
    
    
  
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
code{color:#c63501}
th code{color:inherit}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style>
.mdn{font-size:.75em;position:absolute;right:.3em;min-width:0;margin-top:3rem}
.mdn details{width:100%;margin:1px 0;position:relative;z-index:10;box-sizing:border-box;padding:.4em;padding-top:0}
.mdn details[open]{min-width:25ch;max-width:32ch;background:#fff;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px;z-index:11;margin-bottom:.4em}
.mdn summary{text-align:right;cursor:default;margin-right:-.4em}
.mdn summary span{font-family:zillaslab,Palatino,"Palatino Linotype",serif;color:#fff;background-color:#000;display:inline-block;padding:3px}
.mdn a{display:inline-block;word-break:break-all}
.mdn p{margin:0}
.mdn .engines-all{color:#058b00}
.mdn .engines-some{color:#b00}
.mdn table{width:100%;font-size:.9em}
.mdn td{border:none}
.mdn td:nth-child(2){text-align:right}
.mdn .nosupportdata{font-style:italic;margin:0}
.mdn tr::before{content:"";display:table-cell;width:1.5em;height:1.5em;background:no-repeat center center/contain;font-size:.75em}
.mdn .no,.mdn .unknown{color:#ccc;filter:grayscale(100%)}
.mdn .no::before,.mdn .unknown::before{opacity:.5}
.mdn .chrome::before,.mdn .chrome_android::before{background-image:url(https://resources.whatwg.org/browser-logos/chrome.svg)}
.mdn .edge::before,.mdn .edge_mobile::before{background-image:url(https://resources.whatwg.org/browser-logos/edge.svg)}
.mdn .firefox::before,.mdn .firefox_android::before{background-image:url(https://resources.whatwg.org/browser-logos/firefox.png)}
.mdn .ie::before{background-image:url(https://resources.whatwg.org/browser-logos/ie.png)}
.mdn .opera::before,.mdn .opera_android::before{background-image:url(https://resources.whatwg.org/browser-logos/opera.svg)}
.mdn .safari::before{background-image:url(https://resources.whatwg.org/browser-logos/safari.png)}
.mdn .safari_ios::before{background-image:url(https://resources.whatwg.org/browser-logos/safari-ios.svg)}
.mdn .samsunginternet_android::before{background-image:url(https://resources.whatwg.org/browser-logos/samsung.svg)}
.mdn .webview_android::before{background-image:url(https://resources.whatwg.org/browser-logos/android-webview.png)}
</style>
<meta name="description" content="This specification defines common infrastructure that other specifications can use to
        interact with browser permissions that allow or deny access to powerful features on the web
        platform. For developers, the specification defines an API to query the permission state of
        a powerful feature, or be notified if a permission for a powerful feature changes state.">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<style>
.assert{background:#eee;border-left:.5em solid #aaa;padding:.3em}
</style>
<script id="initialUserConfig" type="application/json">{
  "shortName": "permissions",
  "group": "webappsec",
  "specStatus": "ED",
  "editors": [
    {
      "name": "Marcos Cáceres",
      "url": "https://www.w3.org/",
      "company": "W3C",
      "companyURL": "https://www.w3.org/",
      "w3cid": "39125"
    },
    {
      "name": "Mike Taylor",
      "url": "https://miketaylr.com/posts/",
      "companyURL": "https://google.com/",
      "company": "Google LLC",
      "w3cid": "90704"
    }
  ],
  "formerEditors": [
    {
      "name": "Mounir Lamouri",
      "companyURL": "https://google.com/",
      "company": "Google LLC"
    },
    {
      "name": "Jeffrey Yasskin",
      "companyURL": "https://google.com/",
      "company": "Google LLC",
      "w3cid": "72192"
    }
  ],
  "github": {
    "branch": "main",
    "repoURL": "w3c/permissions"
  },
  "mdn": true,
  "xref": "web-platform",
  "localBiblio": {
    "powerful-feature-registry": {
      "title": "Registry of Powerful Features",
      "href": "https://w3c.github.io/powerful-features-registry/",
      "status": "unofficial",
      "id": "powerful-feature-registry"
    }
  },
  "publishISODate": "2022-03-02T00:00:00.000Z",
  "generatedSubtitle": "W3C Editor's Draft 02 March 2022"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED"></head>
  <body class="h-entry" data-cite="WEBIDL HTML INFRA URL WEBIDL DOM FETCH"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">Permissions</h1> <h2 id="subtitle" class="subtitle">
      Interacting with Permissions for Powerful Features
    </h2>
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">W3C Editor's Draft</a> <time class="dt-published" datetime="2022-03-02">02 March 2022</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://w3c.github.io/permissions/">https://w3c.github.io/permissions/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/permissions/">https://www.w3.org/TR/permissions/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/permissions/">https://w3c.github.io/permissions/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/permissions">https://www.w3.org/standards/history/permissions</a>
                  </dd><dd>
                    <a href="https://github.com/w3c/permissions/commits/main">Commit history</a>
                  </dd>
        
        
        
        
        
        <dt>Editors:</dt><dd class="editor p-author h-card vcard" data-editor-id="39125">
    <a class="u-url url p-name fn" href="https://www.w3.org/">Marcos Cáceres</a> (<a class="p-org org h-org" href="https://www.w3.org/">W3C</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="90704">
    <a class="u-url url p-name fn" href="https://miketaylr.com/posts/">Mike Taylor</a> (<a class="p-org org h-org" href="https://google.com/">Google LLC</a>)
  </dd>
        <dt>
                Former editors:
              </dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Mounir Lamouri</span> (<a class="p-org org h-org" href="https://google.com/">Google LLC</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="72192">
    <span class="p-name fn">Jeffrey Yasskin</span> (<a class="p-org org h-org" href="https://google.com/">Google LLC</a>)
  </dd>
        
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/permissions/">GitHub w3c/permissions</a>
        (<a href="https://github.com/w3c/permissions/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/permissions/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/permissions/issues/">open issues</a>)
      </dd>
        
        
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    ©
    2022
    
    <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>,
    <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
    
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
        This specification defines common infrastructure that other specifications can use to
        interact with browser permissions that allow or deny access to powerful features on the web
        platform. For developers, the specification defines an API to query the permission state of
        a powerful feature, or be notified if a permission for a powerful feature changes state.
      </p>
    </section>
    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p>
      <p>
        This is a work in progress.
      </p>
    <p>
    This document was published by the <a href="https://www.w3.org/groups/wg/webappsec">Web Application Security Working Group</a> as
    an Editor's Draft. 
  </p><p>Publication as an Editor's Draft does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy-20170801/">1 August 2017 <abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/webappsec/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/Consortium/Patent-Policy-20170801/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/Consortium/Patent-Policy-20170801/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                  This document is governed by the
                  <a id="w3c_process_revision" href="https://www.w3.org/2021/Process-20211102/">2 November 2021 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#examples"><bdi class="secno">1. </bdi>
        Examples of usage
      </a></li><li class="tocline"><a class="tocxref" href="#model"><bdi class="secno">2. </bdi>
        Model
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#permissions"><bdi class="secno">2.1 </bdi>
          Permissions
        </a></li><li class="tocline"><a class="tocxref" href="#powerful-features"><bdi class="secno">2.2 </bdi>
          Powerful features
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#aspects"><bdi class="secno">2.2.1 </bdi>
            Aspects
          </a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#specifying-a-powerful-feature"><bdi class="secno">3. </bdi>
        Specifying a powerful feature
      </a></li><li class="tocline"><a class="tocxref" href="#algorithms-to-interface-with-permissions"><bdi class="secno">4. </bdi>
        Algorithms to interface with permissions
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#reading-current-states"><bdi class="secno">4.1 </bdi>
          Reading the current permission state
        </a></li><li class="tocline"><a class="tocxref" href="#requesting-more-permission"><bdi class="secno">4.2 </bdi>
          Requesting permission to use a powerful feature
        </a></li><li class="tocline"><a class="tocxref" href="#prompt-the-user-to-choose"><bdi class="secno">4.3 </bdi>
          Prompt the user to choose
        </a></li><li class="tocline"><a class="tocxref" href="#reacting-to-revocation"><bdi class="secno">4.4 </bdi>
          Reacting to users revoking permission
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#permissions-api"><bdi class="secno">5. </bdi>
        Permissions API
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#navigator-and-workernavigator-extension"><bdi class="secno">5.1 </bdi>
          Extensions to the <code>Navigator</code> and <code>WorkerNavigator</code> interfaces
        </a></li><li class="tocline"><a class="tocxref" href="#permissions-interface"><bdi class="secno">5.2 </bdi>
          <code>Permissions</code> interface
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#query-method"><bdi class="secno">5.2.1 </bdi>
            <code>query()</code> method
          </a></li></ol></li><li class="tocline"><a class="tocxref" href="#permissionstatus-interface"><bdi class="secno">5.3 </bdi>
          <code>PermissionStatus</code> interface
        </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#creating-instances"><bdi class="secno">5.3.1 </bdi>
            Creating instances
          </a></li><li class="tocline"><a class="tocxref" href="#name-attribute"><bdi class="secno">5.3.2 </bdi>
            <code>name</code> attribute
          </a></li><li class="tocline"><a class="tocxref" href="#state-attribute"><bdi class="secno">5.3.3 </bdi>
            <code>state</code> attribute
          </a></li><li class="tocline"><a class="tocxref" href="#onchange-attribute"><bdi class="secno">5.3.4 </bdi>
            <code>onchange</code> attribute
          </a></li><li class="tocline"><a class="tocxref" href="#permissionstatus-gc"><bdi class="secno">5.3.5 </bdi>
            Garbage collection
          </a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">6. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#relationship-to-permissions-policy"><bdi class="secno">A. </bdi>
        Relationship to the Permissions Policy specification
      </a></li><li class="tocline"><a class="tocxref" href="#automation"><bdi class="secno">B. </bdi>
        Automated testing
      </a><ol class="toc"><li class="tocline"><a class="tocxref" href="#set-permission-command"><bdi class="secno">B.1 </bdi>
          Set Permission
        </a></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">C. </bdi>
        Privacy considerations
      </a></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">D. </bdi>
        Security considerations
      </a></li><li class="tocline"><a class="tocxref" href="#idl-index"><bdi class="secno">E. </bdi>IDL Index</a></li><li class="tocline"><a class="tocxref" href="#acknowledgments"><bdi class="secno">F. </bdi>
        Acknowledgments
      </a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">G. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">G.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">G.2 </bdi>Informative references</a></li></ol></li></ol></nav>
    <section class="informative" id="examples-of-usage"><div class="header-wrapper"><h2 id="examples"><bdi class="secno">1. </bdi>
        Examples of usage
      </h2><a class="self-link" href="#examples" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        This example uses the Permissions API to decide whether local news should be shown using
        the Geolocation API or with a button offering to add the feature.
      </p>
      <div class="example" id="example-using-state-attribute">
        <div class="marker">
    <a class="self-link" href="#example-using-state-attribute">Example<bdi> 1</bdi></a><span class="example-title">: Using .state attribute</span>
  </div> <pre aria-busy="false"><code class="hljs js"><span class="hljs-keyword">const</span> { state } = <span class="hljs-keyword">await</span> navigator.permissions.query({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"geolocation"</span>
});
<span class="hljs-keyword">switch</span> (state) {
  <span class="hljs-keyword">case</span> <span class="hljs-string">"granted"</span>:
    showLocalNewsWithGeolocation();
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"prompt"</span>:
    showButtonToEnableLocalNews();
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"denied"</span>:
    showNationalNews();
    <span class="hljs-keyword">break</span>;
}</code></pre>
      </div>
      <p>
        This example simultaneously checks the state of the <code>"geolocation"</code> and <code>"notifications"</code>
        <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-1">powerful features</a>:
      </p>
      <div class="example" id="example-checking-the-state-of-multiple-permissions">
        <div class="marker">
    <a class="self-link" href="#example-checking-the-state-of-multiple-permissions">Example<bdi> 2</bdi></a><span class="example-title">: Checking the state of multiple permissions</span>
  </div> <pre aria-busy="false"><code class="hljs js"><span class="hljs-keyword">const</span> queryPromises = [<span class="hljs-string">"geolocation"</span>, <span class="hljs-string">"notifications"</span>].map(
  <span class="hljs-function"><span class="hljs-params">name</span> =&gt;</span> navigator.permissions.query({ name })
);
<span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> status <span class="hljs-keyword">of</span> queryPromises) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${status.name}</span>: <span class="hljs-subst">${status.state}</span>`</span>);
}</code></pre>
      </div>
      <p>
        This example is checking the permission state of the available cameras.
      </p>
      <div class="example" id="example-checking-permission-state-of-multiple-cameras">
        <div class="marker">
    <a class="self-link" href="#example-checking-permission-state-of-multiple-cameras">Example<bdi> 3</bdi></a><span class="example-title">: Checking permission state of multiple cameras</span>
  </div> <pre aria-busy="false"><code class="hljs js"><span class="hljs-keyword">const</span> devices = <span class="hljs-keyword">await</span> navigator.mediaDevices.enumerateDevices();

<span class="hljs-comment">// filter on video inputs, and map to query object</span>
<span class="hljs-keyword">const</span> queries = devices
  .filter(<span class="hljs-function">(<span class="hljs-params">{ kind }</span>) =&gt;</span> kind === <span class="hljs-string">"videoinput"</span>)
  .map(<span class="hljs-function">(<span class="hljs-params">{ deviceId }</span>) =&gt;</span> ({ <span class="hljs-attr">name</span>: <span class="hljs-string">"camera"</span>, deviceId }));

<span class="hljs-keyword">const</span> promises = queries.map(<span class="hljs-function">(<span class="hljs-params">queryObj</span>) =&gt;</span>
  navigator.permissions.query(queryObj)
);

<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(promises);
  <span class="hljs-comment">// log the state of each camera</span>
  results.forEach(<span class="hljs-function">(<span class="hljs-params">{ state }, i</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Camera"</span>, i, state));
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(error);
}</code></pre>
      </div>
    </section>
    <section id="model"><div class="header-wrapper"><h2 id="x2-model"><bdi class="secno">2. </bdi>
        Model
      </h2><a class="self-link" href="#model" aria-label="Permalink for Section 2."></a></div>
      
      <p>
        This section specifies a model for <a data-link-type="dfn" href="#dfn-permission" class="internalDFN" id="ref-for-dfn-permission-1">permissions</a> to use <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-2">powerful features</a> on the Web
        platform.
      </p>
      <section id="permissions"><div class="header-wrapper"><h3 id="x2-1-permissions"><bdi class="secno">2.1 </bdi>
          Permissions
        </h3><a class="self-link" href="#permissions" aria-label="Permalink for Section 2.1"></a></div>
        
        <p>
          A <dfn class="export" data-export="" data-plurals="permissions" id="dfn-permission" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">permission</dfn> represents a user's decision as to whether a web
          application can use a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-3">powerful feature</a>. The decision is represented as a permission
          <a data-link-type="dfn" href="#dfn-states" class="internalDFN" id="ref-for-dfn-states-1">state</a>.
        </p>
        <p>
          <dfn class="export" data-export="" id="dfn-express-permission" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Express permission</dfn> refers to the user
          <a data-link-type="dfn" data-lt="grants" href="#dfn-granted" class="internalDFN" id="ref-for-dfn-granted-1">granting</a> the web application the ability to use a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-4">powerful feature</a>.
        </p>
        <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span><span class="issue-label">: Limitations</span></div><aside class="">
          <p>
            Current Web APIs have different ways to deal with permissions. For example, the
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-notifications" title="Notifications API Standard">notifications</a></cite>] API allows developers to request a permission and check the
            permission status explicitly. Others expose the status to web pages when they try to
            use the API, like the <cite><a data-matched-text="[[[Geolocation]]]" href="https://www.w3.org/TR/geolocation/">Geolocation API</a></cite> which fails if the permission was not granted
            without allowing the developer to check beforehand.
          </p>
          <p>
            The solution described in this document is meant to be extensible, but isn't expected
            to be applicable to all the current and future permissions available in the web
            platform. Working Groups that are creating specifications whose permission model
            doesn't fit in the model described in this document should contact the editors by
            <a href="https://github.com/w3c/permissions/issues">filing an issue</a>.
          </p>
        </aside></div>
        <p>
          Conceptually, a <a data-link-type="dfn" href="#dfn-permission" class="internalDFN" id="ref-for-dfn-permission-2">permission</a> for a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-5">powerful feature</a> can be in one of the following
          <dfn data-dfn-for="permission" data-local-lt="state" data-lt="states|state" id="dfn-states" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">states</dfn>:
        </p>
        <dl data-sort=""><dt>
            <dfn class="export" data-dfn-for="permission" data-export="" id="dfn-denied" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Denied</dfn>:
          </dt>
          <dd>
            The user, or the user agent on the user's behalf, has denied access to this <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-6">powerful feature</a>. The caller will not be able to use the feature.
          </dd><dt>
            <dfn class="export" data-local-lt="grant" data-dfn-for="permission" data-export="" data-lt="Granted|grant" data-plurals="grants" id="dfn-granted" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Granted</dfn>:
          </dt>
          <dd>
            The user, or the user agent on the user's behalf, has given <a data-link-type="dfn" href="#dfn-express-permission" class="internalDFN" id="ref-for-dfn-express-permission-1">express permission</a> to
            use a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-7">powerful feature</a>. The caller will be able to use the feature possibly without
            having the <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#user-agent">user agent</a> asking the user's permission.
          </dd>
          <dt>
            <dfn class="export" data-dfn-for="permission" data-export="" id="dfn-prompt" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Prompt</dfn>:
          </dt>
          <dd>
            The user has not given <a data-link-type="dfn" href="#dfn-express-permission" class="internalDFN" id="ref-for-dfn-express-permission-2">express permission</a> to use the feature (i.e., it's the same a
            <a data-link-type="dfn" href="#dfn-denied" class="internalDFN" id="ref-for-dfn-denied-1">denied</a>). It also means that if caller attempts to use the feature, the
            <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#user-agent">user agent</a> will either be prompting the user for permission or access to the
            feature will be <a data-link-type="dfn" href="#dfn-denied" class="internalDFN" id="ref-for-dfn-denied-2">denied</a>.
          </dd>
          </dl>
        <p>
          To ascertain <dfn class="export" data-export="" id="dfn-new-information-about-the-user-s-intent" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">new information about the user's intent</dfn>, a user
          agent <em class="rfc2119">MAY</em> collect information about a user's intentions. This information can come from
          explicit user action, aggregate behavior of both the relevant user and other users, or
          <dfn id="dfn-implicit-signals" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">implicit signals</dfn> this specification hasn't anticipated.
        </p>
        <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>Note</span><span class="issue-label">: Implicit signals</span></div><aside class="" data-cite="appmanifest">
          <p>
            The <a href="#dfn-implicit-signals" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-implicit-signals-1">implicit signals</a> could be, for example, the <a data-link-type="dfn" data-lt="installed web application" data-type="dfn" href="https://www.w3.org/TR/appmanifest/#dfn-installed-web-application">install</a> status of a web application or frequency and recency of visits. A
            user that has installed a web application and used it frequently and recently is more
            likely to trust it. Implementations are advised to exercise caution when relying on
            implicit signals.
          </p>
        </aside></div>
        <p>
          Every <a data-link-type="dfn" href="#dfn-permission" class="internalDFN" id="ref-for-dfn-permission-3">permission</a> has a <dfn class="export" data-dfn-for="permission" data-export="" data-plurals="lifetimes" id="dfn-lifetime" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">lifetime</dfn>,
          which is the duration for which a particular permission remains <a data-link-type="dfn" href="#dfn-granted" class="internalDFN" id="ref-for-dfn-granted-2">granted</a>
          before it reverts back to its <a data-link-type="dfn" href="#dfn-default-state" class="internalDFN" id="ref-for-dfn-default-state-1">default state</a>. A <a data-link-type="dfn" href="#dfn-lifetime" class="internalDFN" id="ref-for-dfn-lifetime-1">lifetime</a>
          could be until a particular Realm is destroyed, until a particular <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">top-level browsing context</a> is destroyed, an amount of time, or infinite. The lifetime is negotiated
          between the end-user and the <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#user-agent">user agent</a> when the user gives <a data-link-type="dfn" href="#dfn-express-permission" class="internalDFN" id="ref-for-dfn-express-permission-3">express permission</a> to
          use a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-8">feature</a> — usually via some permission UI or user-agent defined policy.
        </p>
        <p>
          Every permission has a <dfn data-for="permission" id="dfn-default-state" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">default state</dfn> (usually
          <a data-link-type="dfn" href="#dfn-prompt" class="internalDFN" id="ref-for-dfn-prompt-1">prompt</a>), which is the <a data-link-type="dfn" href="#dfn-states" class="internalDFN" id="ref-for-dfn-states-2">state</a> that the permission is in when
          the user has not yet given <a data-link-type="dfn" href="#dfn-express-permission" class="internalDFN" id="ref-for-dfn-express-permission-4">express permission</a> to use the <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-9">feature</a> or it has been
          reset because its <a data-link-type="dfn" href="#dfn-lifetime" class="internalDFN" id="ref-for-dfn-lifetime-2">lifetime</a> has expired.
        </p>
      </section>
      <section id="powerful-features"><div class="header-wrapper"><h3 id="x2-2-powerful-features"><bdi class="secno">2.2 </bdi>
          Powerful features
        </h3><a class="self-link" href="#powerful-features" aria-label="Permalink for Section 2.2"></a></div>
        
        <p>
          A <dfn class="export" data-local-lt="feature" data-export="" data-lt="powerful feature|feature" data-plurals="powerful features|features" id="dfn-powerful-feature" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">powerful feature</dfn> is a web platform
          feature (usually an API) for which a user gives <a data-link-type="dfn" href="#dfn-express-permission" class="internalDFN" id="ref-for-dfn-express-permission-5">express permission</a> before the feature
          can be used. Access to the feature is determined by the user having
          <a data-link-type="dfn" href="#dfn-granted" class="internalDFN" id="ref-for-dfn-granted-3">granted</a> permission, or by satisfying some criteria that is equivalent to a
          permission <a data-link-type="dfn" href="#dfn-granted" class="internalDFN" id="ref-for-dfn-granted-4">grant</a>.
        </p>
        <p>
          A <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-10">powerful feature</a> is identified by its <dfn class="export" data-dfn-for="powerful feature" data-export="" id="dfn-name" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">name</dfn>, which is a string literal (e.g., "geolocation").
        </p>
        <p>
          The user agent is responsible for tracking what <a href="#dfn-powerful-feature" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-powerful-feature-11">powerful features</a> each <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm">realm</a> has the user's <a data-link-type="dfn" href="#dfn-permission" class="internalDFN" id="ref-for-dfn-permission-4">permission</a> to use via the <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings object</a>.
        </p>
        <section id="aspects"><div class="header-wrapper"><h4 id="x2-2-1-aspects"><bdi class="secno">2.2.1 </bdi>
            Aspects
          </h4><a class="self-link" href="#aspects" aria-label="Permalink for Section 2.2.1"></a></div>
          
          <p>
            Each <a href="#dfn-powerful-feature" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-powerful-feature-12">powerful feature</a> can define zero or more additional <dfn data-dfn-for="powerful feature" id="dfn-aspects" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">aspects</dfn>. An aspect is defined as WebIDL <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-dictionary">dictionary</a> that
            <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-inherit-dictionary">inherits</a> from <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-1"><code>PermissionDescriptor</code></a> and serves as an WebIDL
            interface's <a data-link-type="dfn" href="#dfn-permission-descriptor-type" class="internalDFN" id="ref-for-dfn-permission-descriptor-type-1">permission descriptor type</a>.
          </p>
          <aside class="example" id="example-defining-your-own-permission-descriptor-type"><div class="marker">
    <a class="self-link" href="#example-defining-your-own-permission-descriptor-type">Example<bdi> 4</bdi></a><span class="example-title">: Defining your own permission descriptor type</span>
  </div>
            <p>
              A hypothetical <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-13">powerful feature</a> "food detector API" has two <a data-link-type="dfn" href="#dfn-aspects" class="internalDFN" id="ref-for-dfn-aspects-1">aspects</a> that allow sensing taste and smell. So, a specification would
              define a new WebIDL interface that <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-inherit-dictionary">inherits</a> <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-2"><code>PermissionDescriptor</code></a>:
            </p>
            <pre aria-busy="false"><code class="hljs javascript">dictionary SensesPermissionDescriptor : PermissionDescriptor {
  boolean canSmell = <span class="hljs-literal">false</span>;
  boolean canTaste = <span class="hljs-literal">false</span>;
}</code></pre>
            <p>
              Which would then be queried via the API in the following way:
            </p>
            <pre aria-busy="false"><code class="hljs js"><span class="hljs-comment">// Check if the "sense" powerful feature is allowed to smell things</span>
<span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> navigator.permissions.query({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"senses"</span>,
  <span class="hljs-attr">canSmell</span>: <span class="hljs-literal">true</span>,
});
<span class="hljs-comment">// Do something interesting with the status.</span></code></pre>
            <p>
              A user can restrict the "sense" powerful feature to only "taste", in which case the
              <a data-link-type="idl" data-lt="PermissionStatus" href="#dom-permissionstatus" class="internalDFN" id="ref-for-dom-permissionstatus-1"><code>PermissionStatus</code></a>'s <a data-link-type="idl" href="#dom-permissionstatus-state" class="internalDFN" id="ref-for-dom-permissionstatus-state-1"><code>state</code></a> above would be
              "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-1"><code>denied</code></a>" .
            </p>
          </aside>
        </section>
      </section>
    </section>
    <section id="specifying-a-powerful-feature"><div class="header-wrapper"><h2 id="x3-specifying-a-powerful-feature"><bdi class="secno">3. </bdi>
        Specifying a powerful feature
      </h2><a class="self-link" href="#specifying-a-powerful-feature" aria-label="Permalink for Section 3."></a></div>
      
      <p>
        When a specification <dfn class="export" data-export="" id="dfn-specifies-a-powerful-feature" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">specifies a powerful feature</dfn> it:
      </p>
      <ol>
        <li><em class="rfc2119">MUST</em> give the <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-14">powerful feature</a> a [powerful feature/name] in the form of a <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#ascii-lowercase">ascii lowercase</a> string.
        </li>
        <li><em class="rfc2119">MAY</em> define a [powerful feature/permission descriptor type] that inherits from
        <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-3"><code>PermissionDescriptor</code></a>.
        </li>
        <li><em class="rfc2119">MAY</em> define zero or more [powerful feature/aspects].
        </li>
        <li><em class="rfc2119">MAY</em> override the algorithms and types given below if the defaults are not suitable for
        a particular <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-15">powerful feature</a>.
        </li>
        <li><em class="rfc2119">MUST</em> register the <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-16">powerful feature</a> in the <cite><a data-matched-text="[[[powerful-feature-registry]]]" href="https://w3c.github.io/powerful-features-registry/">Registry of Powerful Features</a></cite>.
        </li>
      </ol>
      <p class="advisement">
        Registering the newly specified <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-17">powerful features</a> in the
        <cite><a data-matched-text="[[[powerful-feature-registry]]]" href="https://w3c.github.io/powerful-features-registry/">Registry of Powerful Features</a></cite> gives this Working Group an opportunity to provide feedback
        and check that integration with this specification is done effectively.
      </p>
      <dl>
        <dt>
          A <dfn data-dfn-for="powerful feature" class="export" data-export="" id="dfn-permission-descriptor-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">permission descriptor type</dfn>:
        </dt>
        <dd>
          <p>
            <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-4"><code>PermissionDescriptor</code></a> or one of its subtypes. If unspecified, this defaults to
            <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-5"><code>PermissionDescriptor</code></a>.
          </p>
          <p>
            The feature can define a <a href="https://en.wikipedia.org/wiki/Partially_ordered_set">partial order</a> on descriptor
            instances. If <var>descriptorA</var> is <dfn class="export" data-dfn-for="PermissionDescriptor" data-export="" id="dfn-stronger-than" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">stronger than</dfn> <var>descriptorB</var>, then if <var>descriptorA</var>'s
            <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-1">permission state</a> is "<a data-link-type="idl" href="#dom-permissionstate-granted" class="internalDFN" id="ref-for-dom-permissionstate-granted-1"><code>granted</code></a>", <var>descriptorB</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-2">permission
            state</a> must also be "<a data-link-type="idl" href="#dom-permissionstate-granted" class="internalDFN" id="ref-for-dom-permissionstate-granted-2"><code>granted</code></a>", and if <var>descriptorB</var>'s
            <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-3">permission state</a> is "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-2"><code>denied</code></a>", <var>descriptorA</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-4">permission
            state</a> must also be "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-3"><code>denied</code></a>".
          </p>
          <p class="example" id="example-stronger-than">
            <code>{name: "midi", sysex: true}</code> ("midi-with-sysex") is
            <a data-link-type="dfn" href="#dfn-stronger-than" class="internalDFN" id="ref-for-dfn-stronger-than-1">stronger than</a> <code>{name: "midi", sysex: false}</code>
            ("midi-without-sysex"), so if the user denies access to midi-without-sysex, the UA must
            also deny access to midi-with-sysex, and similarly if the user grants access to
            midi-with-sysex, the UA must also grant access to midi-without-sysex.
          </p>
        </dd>
        <dt>
          <dfn data-dfn-for="powerful feature" class="export" data-export="" id="dfn-permission-state-constraints" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">permission state constraints</dfn>:
        </dt>
        <dd>
          Constraints on the values that the UA can return as a descriptor's <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-5">permission
          state</a>. Defaults to no constraints beyond the user's intent.
        </dd>
        <dt>
          <dfn data-dfn-for="powerful feature" class="export" data-export="" id="dfn-extra-permission-data-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">extra permission data type</dfn>:
        </dt>
        <dd>
          <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>Note</span></div><p class="" data-cite="mediacapture-streams ECMAScript">
            Some <a href="#dfn-powerful-feature" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-powerful-feature-18">powerful features</a> have more information associated with them than just a
            <a data-link-type="idl" data-lt="PermissionState" href="#dom-permissionstate" class="internalDFN" id="ref-for-dom-permissionstate-1"><code>PermissionState</code></a>. For example, <a data-link-type="idl" data-lt="getUserMedia()" data-type="method" href="https://www.w3.org/TR/mediacapture-streams/#dom-mediadevices-getusermedia"><code>getUserMedia</code></a><code>()</code> needs to determine
            <em>which</em> cameras the user has granted <a data-link-type="dfn" data-type="dfn" href="https://tc39.es/ecma262/multipage/executable-code-and-execution-contexts.html#current-realm">the current realm record</a>
            permission to access. Each of these features defines an <a data-link-type="dfn" href="#dfn-extra-permission-data-type" class="internalDFN" id="ref-for-dfn-extra-permission-data-type-1">extra permission data type</a>. If a <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a> <var>name</var> names one of these features, then
            <var>name</var>'s <dfn data-dfn-for="powerful feature" class="export" data-export="" id="dfn-extra-permission-data" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">extra permission
            data</dfn> for an optional <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings object</a> <var>settings</var> is the result
            of the following algorithm:
          </p></div>
          <ol class="algorithm">
            <li>If <var>settings</var> wasn't passed, set it to the <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object">current settings object</a>.
            </li>
            <li>If there was a previous invocation of this algorithm with the same <var>name</var> and
            <var>settings</var>, returning <var>previousResult</var>, and the UA has not received <a href="#dfn-new-information-about-the-user-s-intent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-new-information-about-the-user-s-intent-1">new information
            about the user's intent</a> since that invocation, return <var>previousResult</var>.
            </li>
            <li>Return the instance of <var>name</var>'s <a data-link-type="dfn" href="#dfn-extra-permission-data-type" class="internalDFN" id="ref-for-dfn-extra-permission-data-type-2">extra permission data type</a>
            that matches the UA's impression of the user's intent, taking into account any
            <a data-link-type="dfn" href="#dfn-extra-permission-data-constraints" class="internalDFN" id="ref-for-dfn-extra-permission-data-constraints-1">extra permission data constraints</a> for <var>name</var>.
            </li>
          </ol>
          <p>
            If specified, the <a data-link-type="dfn" href="#dfn-extra-permission-data" class="internalDFN" id="ref-for-dfn-extra-permission-data-1">extra permission data</a> algorithm is usable for
            this feature.
          </p>
        </dd>
        <dt>
          Optional <dfn data-dfn-for="powerful feature" class="export" data-export="" id="dfn-extra-permission-data-constraints" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">extra permission data
          constraints</dfn>:
        </dt>
        <dd>
          Constraints on the values that the UA can return as a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-19">powerful feature</a>'s <a data-link-type="dfn" href="#dfn-extra-permission-data" class="internalDFN" id="ref-for-dfn-extra-permission-data-2">extra permission data</a>. Defaults to no constraints beyond the user's intent.
        </dd>
        <dt>
          A <dfn data-dfn-for="powerful feature" class="export" data-export="" id="dfn-permission-result-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">permission result type</dfn>:
        </dt>
        <dd>
          <a data-link-type="idl" data-lt="PermissionStatus" href="#dom-permissionstatus" class="internalDFN" id="ref-for-dom-permissionstatus-2"><code>PermissionStatus</code></a> or one of its subtypes. If unspecified, this defaults to
          <a data-link-type="idl" data-lt="PermissionStatus" href="#dom-permissionstatus" class="internalDFN" id="ref-for-dom-permissionstatus-3"><code>PermissionStatus</code></a>.
        </dd>
        <dt>
          A <dfn data-dfn-for="powerful feature" class="export" data-export="" id="dfn-permission-query-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">permission query algorithm</dfn>:
        </dt>
        <dd>
          <p>
            Takes an instance of the <a data-link-type="dfn" href="#dfn-permission-descriptor-type" class="internalDFN" id="ref-for-dfn-permission-descriptor-type-2">permission descriptor type</a> and a new or
            existing instance of the <a data-link-type="dfn" href="#dfn-permission-result-type" class="internalDFN" id="ref-for-dfn-permission-result-type-1">permission result type</a>, and updates the
            <a data-link-type="dfn" href="#dfn-permission-result-type" class="internalDFN" id="ref-for-dfn-permission-result-type-2">permission result type</a> instance with the query result. Used by
            <a data-link-type="idl" data-lt="Permissions" href="#dom-permissions" class="internalDFN" id="ref-for-dom-permissions-1"><code>Permissions</code></a>' <a data-link-type="idl" data-lt="query(permissionDesc)" href="#dom-permissions-query" class="internalDFN" id="ref-for-dom-permissions-query-1"><code>query</code></a><code>(<var>permissionDesc</var>)</code> method and the
            <a data-link-type="dfn" href="#dfn-permissionstatus-update-steps" class="internalDFN" id="ref-for-dfn-permissionstatus-update-steps-1"><code>PermissionStatus</code> update steps</a>. If unspecified, this defaults to the <a href="#dfn-default-permission-query-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-default-permission-query-algorithm-1">default
            permission query algorithm</a>.
          </p>
          <p>
            The <dfn id="dfn-default-permission-query-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">default permission query algorithm</dfn>, given a <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-6"><code>PermissionDescriptor</code></a>
            <var>permissionDesc</var> and a <a data-link-type="idl" data-lt="PermissionStatus" href="#dom-permissionstatus" class="internalDFN" id="ref-for-dom-permissionstatus-4"><code>PermissionStatus</code></a> <var>status</var>, runs the following
            steps:
          </p>
          <ol class="algorithm">
            <li>Set <code><var>status</var>.state</code> to <var>permissionDesc</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-6">permission state</a>.
            </li>
          </ol>
        </dd>
        <dt>
          A <dfn data-dfn-for="powerful feature" class="export" data-export="" id="dfn-permission-revocation-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">permission revocation
          algorithm</dfn>:
        </dt>
        <dd>
          <p>
            Takes no arguments. Updates any other parts of the implementation that need to be kept
            in sync with changes in the results of <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-7">permission states</a> or <a data-link-type="dfn" href="#dfn-extra-permission-data" class="internalDFN" id="ref-for-dfn-extra-permission-data-3">extra permission data</a>, and then <a data-link-type="dfn" href="#dfn-react-to-the-user-revoking-permission" class="internalDFN" id="ref-for-dfn-react-to-the-user-revoking-permission-1">react to the user revoking permission</a>.
          </p>
          <p>
            If unspecified, this defaults to running <a data-link-type="dfn" href="#dfn-react-to-the-user-revoking-permission" class="internalDFN" id="ref-for-dfn-react-to-the-user-revoking-permission-2">react to the user revoking permission</a>.
          </p>
        </dd>
        <dt>
          A permission <a data-link-type="dfn" href="#dfn-lifetime" class="internalDFN" id="ref-for-dfn-lifetime-3">lifetime</a>:
        </dt>
        <dd>
          <p>
            Specifications that define one or more <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-20">powerful features</a> <em class="rfc2119">SHOULD</em> suggest a
            <a data-link-type="dfn" href="#dfn-permission" class="internalDFN" id="ref-for-dfn-permission-5">permission</a> <a data-link-type="dfn" href="#dfn-lifetime" class="internalDFN" id="ref-for-dfn-lifetime-4">lifetime</a> that is best suited for the particular feature.
            Some guidance on determining the lifetime of a permission is noted below, with a strong
            emphasis on user privacy. If no <a data-link-type="dfn" href="#dfn-lifetime" class="internalDFN" id="ref-for-dfn-lifetime-5">lifetime</a> is specified, the user agent
            provides one.
          </p>
          <p>
            When the permission <a data-link-type="dfn" href="#dfn-lifetime" class="internalDFN" id="ref-for-dfn-lifetime-6">lifetime</a> expires for an origin:
          </p>
          <ol>
            <li>Set the permission back to its default <a data-link-type="dfn" href="#dfn-state" class="internalDFN" id="ref-for-dfn-state-8">permission state</a> (e.g. setting it back
            to "<a data-link-type="dfn" href="#dfn-prompt" class="internalDFN" id="ref-for-dfn-prompt-2">prompt</a>").
            </li>
            <li>For each <var>browsing context</var> associated with the origin (if any), <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">queue a global task</a> on the <a data-link-type="dfn" href="#dfn-permissions-task-source" class="internalDFN" id="ref-for-dfn-permissions-task-source-1">permissions task source</a> with the <var>browsing context</var>'s <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a> to run the <a data-link-type="dfn" href="#dfn-permission-revocation-algorithm" class="internalDFN" id="ref-for-dfn-permission-revocation-algorithm-1">permission revocation algorithm</a>.
            </li>
          </ol>
          <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="3"><span>Note</span><span class="issue-label">: Determining the lifetime of a permission</span></div><aside class="">
            <p>
              For particularly privacy-sensitive <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-21">features</a>, such as <cite><a data-matched-text="[[[GETUSERMEDIA]]]" href="https://www.w3.org/TR/mediacapture-streams/">Media Capture and Streams</a></cite>, which
              can provide a web application access to a user's camera and microphone, some user
              agents expire a permission <a data-link-type="dfn" href="#dfn-granted" class="internalDFN" id="ref-for-dfn-granted-5">grant</a> as soon as a browser tab is closed or
              navigated. For other features, like the <cite><a data-matched-text="[[[Geolocation]]]" href="https://www.w3.org/TR/geolocation/">Geolocation API</a></cite>, user agents are known to
              offer a choice of only granting the permission for the session, or for one day.
              Others, like the <cite><a data-matched-text="[[[Notifications]]]" href="https://notifications.spec.whatwg.org/">Notifications API Standard</a></cite> and <cite><a data-matched-text="[[[push-api]]]" href="https://www.w3.org/TR/push-api/">Push API</a></cite> APIs, remember a user's
              decision indefinitely or until the user manually revokes the permission. Note that
              permission <a data-link-type="dfn" href="#dfn-lifetime" class="internalDFN" id="ref-for-dfn-lifetime-7">lifetimes</a> can vary significantly between user agents.
            </p>
            <p>
              Finding the right balance for the lifetime of a permission requires a lot of thought
              and experimentation, and often evolves over a period of years. Implementers are
              encouraged to work with their UX security teams to find the right balance between
              ease of access to a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-22">powerful feature</a> (i.e., reducing the number of permission
              prompts), respecting a user's privacy, and making users aware when a web application
              is making use of a particular powerful feature (e.g., via some visual or auditory UI
              indicator).
            </p>
            <p>
              If you are unsure about what <a data-link-type="dfn" href="#dfn-lifetime" class="internalDFN" id="ref-for-dfn-lifetime-8">lifetime</a> to suggest for a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-23">powerful feature</a>, please contact the <a href="https://www.w3.org/Privacy/IG/">Privacy
              Interest Group</a> for guidance.
            </p>
          </aside></div>
        </dd>
        <dt>
          <dfn class="export" data-dfn-for="powerful feature" data-export="" id="dfn-default-permission-state" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Default permission state</dfn>:
        </dt>
        <dd>
          <p>
            An <a data-link-type="idl" data-lt="PermissionState" href="#dom-permissionstate" class="internalDFN" id="ref-for-dom-permissionstate-2"><code>PermissionState</code></a> value that serves as a <a data-link-type="dfn" href="#dfn-permission" class="internalDFN" id="ref-for-dfn-permission-6">permission</a>'s <a data-link-type="dfn" href="#dfn-default-state" class="internalDFN" id="ref-for-dfn-default-state-2">default state</a> of a <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-24">powerful feature</a>.
          </p>
          <p>
            If not specified, the <a data-link-type="dfn" href="#dfn-permission" class="internalDFN" id="ref-for-dfn-permission-7">permission</a>'s <a data-link-type="dfn" href="#dfn-default-state" class="internalDFN" id="ref-for-dfn-default-state-3">default state</a> is
            "<a data-link-type="idl" href="#dom-permissionstate-prompt" class="internalDFN" id="ref-for-dom-permissionstate-prompt-1"><code>prompt</code></a>".
          </p>
        </dd>
      </dl>
      <p>
        A <dfn class="export" data-export="" id="dfn-default-powerful-feature" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">default powerful feature</dfn> is a <a href="#dfn-powerful-feature" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-powerful-feature-25">powerful feature</a> with all
        of the above types and algorithms defaulted.
      </p>
    </section>
    <section id="algorithms-to-interface-with-permissions"><div class="header-wrapper"><h2 id="x4-algorithms-to-interface-with-permissions"><bdi class="secno">4. </bdi>
        Algorithms to interface with permissions
      </h2><a class="self-link" href="#algorithms-to-interface-with-permissions" aria-label="Permalink for Section 4."></a></div>
      
      <section data-cite="permissions-policy" id="reading-the-current-permission-state"><div class="header-wrapper"><h3 id="reading-current-states"><bdi class="secno">4.1 </bdi>
          Reading the current permission state
        </h3><a class="self-link" href="#reading-current-states" aria-label="Permalink for Section 4.1"></a></div>
        
        <p>
          To <dfn class="export" data-lt="getting the current permission state|get the current permission state" data-export="" id="dfn-getting-the-current-permission-state" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">get the current
          permission state</dfn>, given a <a data-link-type="dfn" href="#dfn-name" class="internalDFN" id="ref-for-dfn-name-1">name</a> <var>name</var> and an optional
          <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings object</a> <var>settings</var>. This algorithm returns one of the
          <a data-link-type="idl" data-lt="PermissionState" href="#dom-permissionstate" class="internalDFN" id="ref-for-dom-permissionstate-3"><code>PermissionState</code></a> enum values:
        </p>
        <ol class="algorithm">
          <li>Let <var data-type="PermissionDescriptor">descriptor</var> be a newly-created <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-7"><code>PermissionDescriptor</code></a>
          whose <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-1"><code>name</code></a> is initialized with <var>name</var>.
          </li>
          <li>Return the <a data-link-type="dfn" href="#dfn-state" class="internalDFN" id="ref-for-dfn-state-9">permission state</a> of <var data-type="PermissionDescriptor">descriptor</var> and <var>settings</var>.
          </li>
        </ol>
        <p>
          A <var data-type="PermissionDescriptor">descriptor</var>'s <dfn class="export" data-local-lt="state" data-export="" data-lt="permission state|state" data-plurals="permission states" id="dfn-state" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">permission state</dfn> for an
          optional <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings object</a> <var>settings</var> is the result of the following
          algorithm. It returns a <a data-link-type="idl" data-lt="PermissionState" href="#dom-permissionstate" class="internalDFN" id="ref-for-dom-permissionstate-4"><code>PermissionState</code></a> enum value:
        </p>
        <ol class="algorithm">
          <li>If <var>settings</var> wasn't passed, set it to the <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object">current settings object</a>.
          </li>
          <li>If <var>settings</var> is a <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#non-secure-context">non-secure context</a>, return "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-4"><code>denied</code></a>".
          </li>
          <li>Let <var>feature</var> be <var data-type="PermissionDescriptor">descriptor</var>'s <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-2"><code>name</code></a>.
          </li>
          <li>If there exists a <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/permissions-policy-1/#policy-controlled-feature">policy-controlled feature</a> for <var>feature</var> and <var>settings</var> has an
          <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window">associated <code>Document</code></a> run the following step:
            <ol class="algorithm">
              <li>Let <var>document</var> be <var>settings</var>'s <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#concept-document-window">associated <code>Document</code></a>.
              </li>
              <li>If <var>document</var> is not <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use">allowed to use</a> <var>feature</var>, return
              "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-5"><code>denied</code></a>".
              </li>
            </ol>
          </li>
          <li>If there was a previous invocation of this algorithm with the same <var data-type="PermissionDescriptor">descriptor</var> and
          <var>settings</var>, returning <var>previousResult</var>, and the UA has not received <a href="#dfn-new-information-about-the-user-s-intent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-new-information-about-the-user-s-intent-2">new information
          about the user's intent</a> since that invocation, return <var>previousResult</var>.
          </li>
          <li>Return the <a data-link-type="idl" data-lt="PermissionState" href="#dom-permissionstate" class="internalDFN" id="ref-for-dom-permissionstate-5"><code>PermissionState</code></a> enum value that presents permission state of
          <var>feature</var>, taking into account any <a data-link-type="dfn" href="#dfn-permission-state-constraints" class="internalDFN" id="ref-for-dfn-permission-state-constraints-1">permission state constraints</a> for
          <var data-type="PermissionDescriptor">descriptor</var>'s <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-3"><code>name</code></a>.
          </li>
        </ol>
        <div class="issue" id="issue-current-entry-incumbent-or-relevant"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><a href="https://github.com/w3c/permissions/issues/278"><span class="issue-number">Issue 278</span></a><span class="issue-label">: Safari returns different results for current permission state</span></div><p dir="auto">Safari is the only known UA that returns different results from this algorithm for different settings objects with the same origin. We should test which of the <a href="https://html.spec.whatwg.org/multipage/webappapis.html#realms-settings-objects-global-objects" rel="nofollow">several possible settings objects</a> it uses.</p></div>
        <p>
          As a shorthand, a <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a> <var>name</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-10">permission state</a> is the <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-11">permission
          state</a> of a <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-8"><code>PermissionDescriptor</code></a> with its <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-4"><code>name</code></a> member set
          to <var>name</var>.
        </p>
      </section>
      <section id="requesting-permission-to-use-a-powerful-feature"><div class="header-wrapper"><h3 id="requesting-more-permission"><bdi class="secno">4.2 </bdi>
          Requesting permission to use a powerful feature
        </h3><a class="self-link" href="#requesting-more-permission" aria-label="Permalink for Section 4.2"></a></div>
        
        <p>
          To <dfn data-lt="request permission to use|requesting permission to use" class="export" data-export="" id="dfn-request-permission-to-use" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">request permission to use</dfn> a <var>descriptor</var>, the UA must perform the
          following steps. This algorithm returns either "<a data-link-type="idl" href="#dom-permissionstate-granted" class="internalDFN" id="ref-for-dom-permissionstate-granted-3"><code>granted</code></a>" or
          "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-6"><code>denied</code></a>".
        </p>
        <ol class="algorithm">
          <li>Let <var>current state</var> be the <var>descriptor</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-12">permission state</a>.
          </li>
          <li>If <var>current state</var> is not "<a data-link-type="idl" href="#dom-permissionstate-prompt" class="internalDFN" id="ref-for-dom-permissionstate-prompt-2"><code>prompt</code></a>", return <var>current
          state</var> and abort these steps.
          </li>
          <li>Ask the user for <a href="#dfn-express-permission" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-express-permission-6">express permission</a> for the calling algorithm to use the
          <a href="#dfn-powerful-feature" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-powerful-feature-26">powerful feature</a> described by <var>descriptor</var>.
          </li>
          <li>If the user gives <a data-link-type="dfn" href="#dfn-express-permission" class="internalDFN" id="ref-for-dfn-express-permission-7">express permission</a> to use the powerful feature, return
          "<a data-link-type="idl" href="#dom-permissionstate-granted" class="internalDFN" id="ref-for-dom-permissionstate-granted-4"><code>granted</code></a>"; otherwise return "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-7"><code>denied</code></a>". The user's
          interaction may provide <a href="#dfn-new-information-about-the-user-s-intent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-new-information-about-the-user-s-intent-3">new information about the user's intent</a> for this <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm">realm</a> and other <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm">realms</a> with the <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin">same origin</a>.
            <div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="4"><span>Note</span></div><p class="">
              This is intentionally vague about the details of the permission UI and how the UA
              infers user intent. UAs should be able to explore lots of UI within this framework.
            </p></div>
          </li>
        </ol>
        <p>
          As a shorthand, <a href="#dfn-request-permission-to-use" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-request-permission-to-use-1">requesting permission to use</a> a <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a> <var>name</var>, is the same
          as <a href="#dfn-request-permission-to-use" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-request-permission-to-use-2">requesting permission to use</a> a <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-9"><code>PermissionDescriptor</code></a> with its
          <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-5"><code>name</code></a> member set to <var>name</var>.
        </p>
      </section>
      <section id="prompt-the-user-to-choose"><div class="header-wrapper"><h3 id="x4-3-prompt-the-user-to-choose"><bdi class="secno">4.3 </bdi>
          Prompt the user to choose
        </h3><a class="self-link" href="#prompt-the-user-to-choose" aria-label="Permalink for Section 4.3"></a></div>
        
        <p>
          To <dfn data-lt="prompt the user to choose|prompting the user to choose" class="export" data-export="" id="dfn-prompt-the-user-to-choose" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">prompt the user to choose</dfn> one of several <var>options</var> associated with a
          <var>descriptor</var>, the UA must perform the following steps. This algorithm returns either
          "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-8"><code>denied</code></a>" or one of the options.
        </p>
        <ol class="algorithm">
          <li>If <var>descriptor</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-13">permission state</a> is "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-9"><code>denied</code></a>", return
          "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-10"><code>denied</code></a>" and abort these steps.
          </li>
          <li>If <var>descriptor</var>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-14">permission state</a> is "<a data-link-type="idl" href="#dom-permissionstate-granted" class="internalDFN" id="ref-for-dom-permissionstate-granted-5"><code>granted</code></a>", the UA
          may return one of <var>options</var> and abort these steps. If the UA returns without prompting,
          then subsequent <a data-lt="prompt the user to choose" href="#dfn-prompt-the-user-to-choose" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prompt-the-user-to-choose-1">prompts for the user to choose</a>
          from the same set of options with the same <var>descriptor</var> must return the same option,
          unless the UA receives <a href="#dfn-new-information-about-the-user-s-intent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-new-information-about-the-user-s-intent-4">new information about the user's intent</a>.
          </li>
          <li>Ask the user to choose one of the options or deny permission, and wait for them to
          choose. If the calling algorithm specified extra information to include in the prompt,
          include it.
          </li>
          <li>If the user chose an option, return it; otherwise return
          "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-11"><code>denied</code></a>". If the user's interaction indicates they intend this choice
          to apply to other realms, then treat this this as <a href="#dfn-new-information-about-the-user-s-intent" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-new-information-about-the-user-s-intent-5">new information about the user's
          intent</a> for other <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm">realms</a> with the <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin">same origin</a>.
            <div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="4"><span>Note</span></div><p class="">
              This is intentionally vague about the details of the permission UI and how the UA
              infers user intent. UAs should be able to explore lots of UI within this framework.
            </p></div>
          </li>
        </ol>
        <p>
          As a shorthand, <a href="#dfn-prompt-the-user-to-choose" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prompt-the-user-to-choose-2">prompting the user to choose</a> from options associated with a
          <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a> <var>name</var>, is the same as <a href="#dfn-prompt-the-user-to-choose" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-prompt-the-user-to-choose-3">prompting the user to choose</a> from those
          options associated with a <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-10"><code>PermissionDescriptor</code></a> with its <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-6"><code>name</code></a>
          member set to <var>name</var>.
        </p>
      </section>
      <section id="reacting-to-users-revoking-permission"><div class="header-wrapper"><h3 id="reacting-to-revocation"><bdi class="secno">4.4 </bdi>
          Reacting to users revoking permission
        </h3><a class="self-link" href="#reacting-to-revocation" aria-label="Permalink for Section 4.4"></a></div>
        
        <p>
          When the UA learns that the user no longer intends to grant permission for a <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm">realm</a> to use a <a href="#dfn-powerful-feature" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-powerful-feature-27">feature</a>, <dfn id="dfn-react-to-the-user-revoking-permission" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">react to the user revoking permission</dfn>
          by:
        </p>
        <ol class="algorithm">
          <li>
            <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the Realm's <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-settings-object">settings object</a>'s <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#responsible-event-loop">responsible event loop</a> to run that feature's <a data-link-type="dfn" href="#dfn-permission-revocation-algorithm" class="internalDFN" id="ref-for-dfn-permission-revocation-algorithm-2">permission revocation algorithm</a>.
          </li>
        </ol>
      </section>
    </section>
    <section id="permissions-api"><div class="header-wrapper"><h2 id="x5-permissions-api"><bdi class="secno">5. </bdi>
        Permissions API
      </h2><a class="self-link" href="#permissions-api" aria-label="Permalink for Section 5."></a></div>
      
      <aside class="mdn"><details>
    <summary aria-label="Expand MDN details for permissions"><span>MDN</span><span> </span></summary>
    <a title="The Navigator.permissions read-only property returns a Permissions object that can be used to query and update permission status of APIs covered by the Permissions API." href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/permissions">Navigator/permissions</a>
    
    <table>
    <tr class="chrome yes">
      <td>Chrome</td>
      <td>43+</td>
    </tr><tr class="chrome_android yes">
      <td>Chrome Android</td>
      <td>43+</td>
    </tr><tr class="edge no">
      <td>Edge</td>
      <td>No</td>
    </tr><tr class="edge_mobile unknown">
      <td>Edge Mobile</td>
      <td>?</td>
    </tr><tr class="firefox yes">
      <td>Firefox</td>
      <td>46+</td>
    </tr><tr class="firefox_android yes">
      <td>Firefox Android</td>
      <td>46+</td>
    </tr><tr class="ie no">
      <td>Internet Explorer</td>
      <td>No</td>
    </tr><tr class="opera yes">
      <td>Opera</td>
      <td>30+</td>
    </tr><tr class="opera_android yes">
      <td>Opera Android</td>
      <td>30+</td>
    </tr><tr class="safari no">
      <td>Safari</td>
      <td>No</td>
    </tr><tr class="safari_ios no">
      <td>Safari iOS</td>
      <td>No</td>
    </tr><tr class="samsunginternet_android yes">
      <td>Samsung Internet</td>
      <td>4.0+</td>
    </tr><tr class="webview_android no">
      <td>WebView Android</td>
      <td>No</td>
    </tr>
  </table>
  </details><details>
    <summary aria-label="Expand MDN details for permissions"><span>MDN</span><span title="This feature has limited support.">🚫</span></summary>
    <a title="The WorkerNavigator.permissions read-only property returns a Permissions object that can be used to query and update permission status of APIs covered by the Permissions API." href="https://developer.mozilla.org/en-US/docs/Web/API/WorkerNavigator/permissions">WorkerNavigator/permissions</a>
    <p class="engines-some">This feature has limited support.</p>
    <table>
    <tr class="chrome yes">
      <td>Chrome</td>
      <td>43+</td>
    </tr><tr class="chrome_android yes">
      <td>Chrome Android</td>
      <td>43+</td>
    </tr><tr class="edge no">
      <td>Edge</td>
      <td>No</td>
    </tr><tr class="edge_mobile unknown">
      <td>Edge Mobile</td>
      <td>?</td>
    </tr><tr class="firefox no">
      <td>Firefox</td>
      <td>No</td>
    </tr><tr class="firefox_android no">
      <td>Firefox Android</td>
      <td>No</td>
    </tr><tr class="ie no">
      <td>Internet Explorer</td>
      <td>No</td>
    </tr><tr class="opera yes">
      <td>Opera</td>
      <td>30+</td>
    </tr><tr class="opera_android yes">
      <td>Opera Android</td>
      <td>30+</td>
    </tr><tr class="safari no">
      <td>Safari</td>
      <td>No</td>
    </tr><tr class="safari_ios no">
      <td>Safari iOS</td>
      <td>No</td>
    </tr><tr class="samsunginternet_android yes">
      <td>Samsung Internet</td>
      <td>4.0+</td>
    </tr><tr class="webview_android no">
      <td>WebView Android</td>
      <td>No</td>
    </tr>
  </table>
  </details></aside><section id="extensions-to-the-navigator-and-workernavigator-interfaces"><div class="header-wrapper"><h3 id="navigator-and-workernavigator-extension"><bdi class="secno">5.1 </bdi>
          Extensions to the <code>Navigator</code> and <code>WorkerNavigator</code> interfaces
        </h3><a class="self-link" href="#navigator-and-workernavigator-extension" aria-label="Permalink for Section 5.1"></a></div>
        
        <pre class="idl def" id="webidl-2112232240"><span class="idlHeader"><a class="self-link" href="#webidl-2112232240">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-navigator-partial-1" data-title="Navigator">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window)</span>]
partial interface <a data-idl="partial" data-link-type="interface" data-title="Navigator" class="idlID" data-dfn-for="Navigator" data-type="interface" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator">Navigator</a> {<span data-idl="" class="idlAttribute" id="idl-def-navigator-permissions" data-title="permissions" data-dfn-for="Navigator">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject">SameObject</a></span>] readonly attribute<span class="idlType"> <a href="#dfn-permission" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-permission-8">Permissions</a></span> <dfn data-export="" data-dfn-type="attribute" id="dom-navigator-permissions" data-idl="attribute" data-title="permissions" data-dfn-for="Navigator" data-type="Permissions" data-lt="permissions" data-local-lt="Navigator.permissions" class="idlName" tabindex="0" aria-haspopup="dialog"><code>permissions</code></dfn>;</span>
};</span><span data-idl="" class="idlInterface" id="idl-def-workernavigator-partial-1" data-title="WorkerNavigator">

[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Worker)</span>]
partial interface <a data-idl="partial" data-link-type="interface" data-title="WorkerNavigator" class="idlID" data-dfn-for="WorkerNavigator" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator">WorkerNavigator</a> {<span data-idl="" class="idlAttribute" id="idl-def-workernavigator-permissions" data-title="permissions" data-dfn-for="WorkerNavigator">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject">SameObject</a></span>] readonly attribute<span class="idlType"> <a href="#dfn-permission" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-permission-9">Permissions</a></span> <dfn data-export="" data-dfn-type="attribute" id="dom-workernavigator-permissions" data-idl="attribute" data-title="permissions" data-dfn-for="WorkerNavigator" data-type="Permissions" data-lt="permissions" data-local-lt="WorkerNavigator.permissions" class="idlName" tabindex="0" aria-haspopup="dialog"><code>permissions</code></dfn>;</span>
};</span></code></pre>
      </section>
      <aside class="mdn"><details>
    <summary aria-label="Expand MDN details for Permissions"><span>MDN</span><span> </span></summary>
    <a title="The Permissions interface of the Permissions API provides the core Permission API functionality, such as methods for querying and revoking permissions" href="https://developer.mozilla.org/en-US/docs/Web/API/Permissions">Permissions</a>
    
    <table>
    <tr class="chrome yes">
      <td>Chrome</td>
      <td>43+</td>
    </tr><tr class="chrome_android yes">
      <td>Chrome Android</td>
      <td>43+</td>
    </tr><tr class="edge no">
      <td>Edge</td>
      <td>No</td>
    </tr><tr class="edge_mobile unknown">
      <td>Edge Mobile</td>
      <td>?</td>
    </tr><tr class="firefox yes">
      <td>Firefox</td>
      <td>46+</td>
    </tr><tr class="firefox_android yes">
      <td>Firefox Android</td>
      <td>46+</td>
    </tr><tr class="ie no">
      <td>Internet Explorer</td>
      <td>No</td>
    </tr><tr class="opera yes">
      <td>Opera</td>
      <td>30+</td>
    </tr><tr class="opera_android yes">
      <td>Opera Android</td>
      <td>30+</td>
    </tr><tr class="safari no">
      <td>Safari</td>
      <td>No</td>
    </tr><tr class="safari_ios no">
      <td>Safari iOS</td>
      <td>No</td>
    </tr><tr class="samsunginternet_android yes">
      <td>Samsung Internet</td>
      <td>4.0+</td>
    </tr><tr class="webview_android no">
      <td>WebView Android</td>
      <td>No</td>
    </tr>
  </table>
  </details></aside><section data-dfn-for="Permissions" id="permissions-interface-0"><div class="header-wrapper"><h3 id="permissions-interface"><bdi class="secno">5.2 </bdi>
          <code>Permissions</code> interface
        </h3><a class="self-link" href="#permissions-interface" aria-label="Permalink for Section 5.2"></a></div>
        
        <pre class="idl def" id="webidl-285612776"><span class="idlHeader"><a class="self-link" href="#webidl-285612776">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-permissions" data-title="Permissions">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window,Worker)</span>]
interface <dfn data-export="" data-dfn-type="interface" id="dom-permissions" data-idl="interface" data-title="Permissions" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>Permissions</code></dfn> {<span data-idl="" class="idlMethod" id="idl-def-permissions-query-permissiondesc" data-title="query" data-dfn-for="Permissions"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a href="#dom-permissionstatus" class="internalDFN" data-link-type="idl" id="ref-for-dom-permissionstatus-5"><code>PermissionStatus</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-permissions-query" id="ref-for-dom-permissions-query-2"><code>query</code></a>(<span class="idlType"><a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a></span> <span class="idlParamName">permissionDesc</span>);</span>
};</span><span data-idl="" class="idlDictionary" id="idl-def-permissiondescriptor" data-title="PermissionDescriptor">

dictionary <dfn data-export="" data-dfn-type="dictionary" id="dom-permissiondescriptor" data-idl="dictionary" data-title="PermissionDescriptor" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>PermissionDescriptor</code></dfn> {<span data-idl="" class="idlMember" id="idl-def-permissiondescriptor-name" data-title="name" data-dfn-for="PermissionDescriptor">
  required<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-permissiondescriptor-name" data-idl="field" data-title="name" data-dfn-for="PermissionDescriptor" data-type="DOMString" class="idlName" tabindex="0" aria-haspopup="dialog"><code>name</code></dfn>;</span>
};</span></code></pre>
        <aside class="mdn"><details>
    <summary aria-label="Expand MDN details for query"><span>MDN</span><span> </span></summary>
    <a title="The Permissions.query() method of the Permissions interface returns the state of a user permission on the global scope." href="https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query">Permissions/query</a>
    
    <table>
    <tr class="chrome yes">
      <td>Chrome</td>
      <td>43+</td>
    </tr><tr class="chrome_android yes">
      <td>Chrome Android</td>
      <td>43+</td>
    </tr><tr class="edge no">
      <td>Edge</td>
      <td>No</td>
    </tr><tr class="edge_mobile unknown">
      <td>Edge Mobile</td>
      <td>?</td>
    </tr><tr class="firefox yes">
      <td>Firefox</td>
      <td>46+</td>
    </tr><tr class="firefox_android yes">
      <td>Firefox Android</td>
      <td>46+</td>
    </tr><tr class="ie no">
      <td>Internet Explorer</td>
      <td>No</td>
    </tr><tr class="opera yes">
      <td>Opera</td>
      <td>30+</td>
    </tr><tr class="opera_android yes">
      <td>Opera Android</td>
      <td>30+</td>
    </tr><tr class="safari no">
      <td>Safari</td>
      <td>No</td>
    </tr><tr class="safari_ios no">
      <td>Safari iOS</td>
      <td>No</td>
    </tr><tr class="samsunginternet_android yes">
      <td>Samsung Internet</td>
      <td>4.0+</td>
    </tr><tr class="webview_android no">
      <td>WebView Android</td>
      <td>No</td>
    </tr>
  </table>
  </details></aside><section id="query-method-0"><div class="header-wrapper"><h4 id="query-method"><bdi class="secno">5.2.1 </bdi>
            <code>query()</code> method
          </h4><a class="self-link" href="#query-method" aria-label="Permalink for Section 5.2.1"></a></div>
          
          <p>
            When the <dfn data-export="" data-dfn-type="method" id="dom-permissions-query" data-idl="operation" data-title="query()" data-dfn-for="Permissions" data-type="Promise" data-lt="query()|query(permissionDesc)" data-local-lt="Permissions.query|Permissions.query()|query" tabindex="0" aria-haspopup="dialog"><code>query()</code></dfn> method is invoked, the <a data-type="dfn" href="https://infra.spec.whatwg.org/#user-agent">user agent</a> <em class="rfc2119">MUST</em> run the
            following <dfn class="export" data-export="" id="dfn-query-a-permission" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">query a permission</dfn> algorithm, passing the parameter
            <var>permissionDesc</var>:
          </p>
          <ol class="algorithm">
            <li>If <var>permissionDesc</var>'s <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-7"><code>name</code></a> member is not supported, return
            <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with">a promise rejected with</a> a <a data-link-type="idl" data-lt="TypeError" data-type="exception" href="https://webidl.spec.whatwg.org/#exceptiondef-typeerror"><code>TypeError</code></a>.
              <div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-5" aria-level="5"><span>Note</span><span class="issue-label">: Why is this not an enum?</span></div><aside class="">
                <p>
                  This is deliberately design to work the same a WebIDL <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-enumeration">enumeration</a> (<code>enum</code>)
                  and implementers are encouraged to use their own custom <code>enum</code> here. The reason
                  this is not an enum in the specification vary greatly in the powerful features
                  they support. Using a <a data-link-type="idl" data-lt="DOMString" data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><code>DOMString</code></a> to identify a powerful feature gives
                  implementers the freedom to pick and choose which of the power features from the
                  <cite><a data-matched-text="[[[powerful-feature-registry]]]" href="https://w3c.github.io/powerful-features-registry/">Registry of Powerful Features</a></cite> they wish to support.
                </p>
              </aside></div>
            </li>
            <li>Let <var>rootDesc</var> be the object <var>permissionDesc</var> refers to, <a data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-convert-ecmascript-to-idl-value">converted to an IDL
            value</a> of type <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-11"><code>PermissionDescriptor</code></a>.
            </li>
            <li>If the conversion <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throws</a> an <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-exception">exception</a>, return <a data-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with">a promise
            rejected with</a> that exception.
            </li>
            <li>Let <var>typedDescriptor</var> be the object <var>permissionDesc</var> refers to, <a data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-convert-ecmascript-to-idl-value">converted to an
            IDL value</a> of <var>rootDesc</var>'s <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-8"><code>name</code></a>'s <a data-link-type="dfn" href="#dfn-permission-descriptor-type" class="internalDFN" id="ref-for-dfn-permission-descriptor-type-3">permission descriptor type</a>.
            </li>
            <li>If the conversion <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw">throws</a> an <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-exception">exception</a>, return <a data-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-rejected-with">a promise
            rejected with</a> that exception.
            </li>
            <li>Let <var>promise</var> be <a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise">a new promise</a>.
            </li>
            <li>Return <var>promise</var> and continue <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:
              <ol>
                <li>Let <var>status</var> be <a href="#dfn-create-a-permissionstatus" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-create-a-permissionstatus-1">create a <code>PermissionStatus</code></a> with <var>typedDescriptor</var>.
                </li>
                <li>Let <var>query</var> be <var>status</var>'s <a data-lt="[[query]]" href="#dfn-query" class="internalDFN" data-link-type="idl" id="ref-for-dfn-query-1"><code>[[query]]</code></a> internal slot.
                </li>
                <li>Run <var>query</var>'s <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-9"><code>name</code></a>'s <a data-link-type="dfn" href="#dfn-permission-query-algorithm" class="internalDFN" id="ref-for-dfn-permission-query-algorithm-1">permission query algorithm</a>, passing <var>query</var> and <var>status</var>.
                </li>
                <li><a data-link-type="dfn" data-type="dfn" href="https://webidl.spec.whatwg.org/#resolve">Resolve</a> <var>promise</var> with <var>status</var>.
                </li>
              </ol>
            </li>
          </ol>
        </section>
      </section>
      <aside class="mdn"><details>
    <summary aria-label="Expand MDN details for PermissionStatus"><span>MDN</span><span> </span></summary>
    <a title="The PermissionStatus interface of the Permissions API provides the state of an object and an event handler for monitoring changes to said state." href="https://developer.mozilla.org/en-US/docs/Web/API/PermissionStatus">PermissionStatus</a>
    
    <table>
    <tr class="chrome yes">
      <td>Chrome</td>
      <td>43+</td>
    </tr><tr class="chrome_android yes">
      <td>Chrome Android</td>
      <td>43+</td>
    </tr><tr class="edge no">
      <td>Edge</td>
      <td>No</td>
    </tr><tr class="edge_mobile unknown">
      <td>Edge Mobile</td>
      <td>?</td>
    </tr><tr class="firefox yes">
      <td>Firefox</td>
      <td>46+</td>
    </tr><tr class="firefox_android yes">
      <td>Firefox Android</td>
      <td>46+</td>
    </tr><tr class="ie no">
      <td>Internet Explorer</td>
      <td>No</td>
    </tr><tr class="opera yes">
      <td>Opera</td>
      <td>30+</td>
    </tr><tr class="opera_android yes">
      <td>Opera Android</td>
      <td>30+</td>
    </tr><tr class="safari no">
      <td>Safari</td>
      <td>No</td>
    </tr><tr class="safari_ios no">
      <td>Safari iOS</td>
      <td>No</td>
    </tr><tr class="samsunginternet_android yes">
      <td>Samsung Internet</td>
      <td>4.0+</td>
    </tr><tr class="webview_android no">
      <td>WebView Android</td>
      <td>No</td>
    </tr>
  </table>
  </details></aside><section data-dfn-for="PermissionStatus" id="permissionstatus-interface-0"><div class="header-wrapper"><h3 id="permissionstatus-interface"><bdi class="secno">5.3 </bdi>
          <code>PermissionStatus</code> interface
        </h3><a class="self-link" href="#permissionstatus-interface" aria-label="Permalink for Section 5.3"></a></div>
        
        <pre class="idl def" id="webidl-1212188233"><span class="idlHeader"><a class="self-link" href="#webidl-1212188233">WebIDL</a></span><code><span data-idl="" class="idlInterface" id="idl-def-permissionstatus" data-title="PermissionStatus">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window,Worker)</span>]
interface <dfn data-export="" data-dfn-type="interface" id="dom-permissionstatus" data-idl="interface" data-title="PermissionStatus" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>PermissionStatus</code></dfn> : <span class="idlSuperclass"><a data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" class="idlAttribute" id="idl-def-permissionstatus-state" data-title="state" data-dfn-for="PermissionStatus">
  readonly attribute<span class="idlType"> <a href="#dom-permissionstate" class="internalDFN" data-link-type="idl" id="ref-for-dom-permissionstate-6"><code>PermissionState</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-permissionstatus-state" id="ref-for-dom-permissionstatus-state-2"><code>state</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-permissionstatus-name" data-title="name" data-dfn-for="PermissionStatus">
  readonly attribute<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-permissionstatus-name" id="ref-for-dom-permissionstatus-name-1"><code>name</code></a>;</span><span data-idl="" class="idlAttribute" id="idl-def-permissionstatus-onchange" data-title="onchange" data-dfn-for="PermissionStatus">
  attribute<span class="idlType"> <a data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-permissionstatus-onchange" id="ref-for-dom-permissionstatus-onchange-1"><code>onchange</code></a>;</span>
};</span><span data-idl="" class="idlEnum" id="idl-def-permissionstate" data-title="PermissionState">

enum <dfn data-export="" data-dfn-type="enum" id="dom-permissionstate" data-idl="enum" data-title="PermissionState" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>PermissionState</code></dfn> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-permissionstate-granted" id="ref-for-dom-permissionstate-granted-6"><code>granted</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-permissionstate-denied" id="ref-for-dom-permissionstate-denied-12"><code>denied</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-permissionstate-prompt" id="ref-for-dom-permissionstate-prompt-3"><code>prompt</code></a>"</span>,
};</span></code></pre>
        <p>
          <a data-link-type="idl" data-lt="PermissionStatus" href="#dom-permissionstatus" class="internalDFN" id="ref-for-dom-permissionstatus-6"><code>PermissionStatus</code></a> instances are created with a <dfn data-idl="" data-dfn-for="PermissionStatus" data-noexport="" data-dfn-type="attribute" id="dfn-query" tabindex="0" aria-haspopup="dialog">[[query]]</dfn> internal slot,
          which is an instance of a feature's <a data-link-type="dfn" href="#dfn-permission-descriptor-type" class="internalDFN" id="ref-for-dfn-permission-descriptor-type-4">permission descriptor type</a>.
        </p>
        <p data-dfn-for="PermissionState">
          The "<dfn data-export="" data-dfn-type="enum-value" id="dom-permissionstate-granted" data-idl="enum-value" data-title="granted" data-dfn-for="PermissionState" tabindex="0" aria-haspopup="dialog"><code>granted</code></dfn>", "<dfn data-export="" data-dfn-type="enum-value" id="dom-permissionstate-denied" data-idl="enum-value" data-title="denied" data-dfn-for="PermissionState" tabindex="0" aria-haspopup="dialog"><code>denied</code></dfn>", and "<dfn data-export="" data-dfn-type="enum-value" id="dom-permissionstate-prompt" data-idl="enum-value" data-title="prompt" data-dfn-for="PermissionState" tabindex="0" aria-haspopup="dialog"><code>prompt</code></dfn>" enum values
          represent the concepts of <a data-link-type="dfn" href="#dfn-granted" class="internalDFN" id="ref-for-dfn-granted-6">granted</a>, <a data-link-type="dfn" href="#dfn-denied" class="internalDFN" id="ref-for-dfn-denied-3">denied</a>, and
          <a data-link-type="dfn" href="#dfn-prompt" class="internalDFN" id="ref-for-dfn-prompt-3">prompt</a> respectively.
        </p>
        <section id="creating-instances"><div class="header-wrapper"><h4 id="x5-3-1-creating-instances"><bdi class="secno">5.3.1 </bdi>
            Creating instances
          </h4><a class="self-link" href="#creating-instances" aria-label="Permalink for Section 5.3.1"></a></div>
          
          <p>
            To <dfn class="export" data-export="" id="dfn-create-a-permissionstatus" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">create a <code>PermissionStatus</code></dfn> for a given
            <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-12"><code>PermissionDescriptor</code></a> <var>permissionDesc</var>:
          </p>
          <ol class="algorithm">
            <li>Let <var data-type="DOMString">name</var> be <var>permissionDesc</var>'s <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-10"><code>name</code></a>.
            </li>
            <li class="assert">Assert: The <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-28">feature</a> identified by <var data-type="DOMString">name</var> is supported by the user agent.
            </li>
            <li>Let <var data-type="PermissionStatus">status</var> be a new instance of the <a data-link-type="dfn" href="#dfn-permission-result-type" class="internalDFN" id="ref-for-dfn-permission-result-type-3">permission result type</a> identified by <var data-type="DOMString">name</var>:
              <ol>
                <li>Initialize <var data-type="PermissionStatus">status</var>'s <a data-lt="[[query]]" href="#dfn-query" class="internalDFN" data-link-type="idl" id="ref-for-dfn-query-2"><code>[[query]]</code></a> internal slot to
                <var>permissionDesc</var>.
                </li>
                <li>Initialize <var data-type="PermissionStatus">status</var>'s <a data-link-type="idl" href="#dom-permissionstatus-name" class="internalDFN" id="ref-for-dom-permissionstatus-name-2"><code>name</code></a> to <var data-type="DOMString">name</var>.
                </li>
              </ol>
            </li>
            <li>Return <var data-type="PermissionStatus">status</var>.
            </li>
          </ol>
        </section>
        <aside class="mdn"><details>
    <summary aria-label="Expand MDN details for name"><span>MDN</span><span title="This feature has limited support.">🚫</span></summary>
    <a title="The name read-only property of the PermissionStatus interface returns the name of a requested permission." href="https://developer.mozilla.org/en-US/docs/Web/API/PermissionStatus/name">PermissionStatus/name</a>
    <p class="engines-some">This feature has limited support.</p>
    <table>
    <tr class="chrome no">
      <td>Chrome</td>
      <td>No</td>
    </tr><tr class="chrome_android no">
      <td>Chrome Android</td>
      <td>No</td>
    </tr><tr class="edge no">
      <td>Edge</td>
      <td>No</td>
    </tr><tr class="edge_mobile unknown">
      <td>Edge Mobile</td>
      <td>?</td>
    </tr><tr class="firefox yes">
      <td>Firefox</td>
      <td>93+</td>
    </tr><tr class="firefox_android yes">
      <td>Firefox Android</td>
      <td>93+</td>
    </tr><tr class="ie no">
      <td>Internet Explorer</td>
      <td>No</td>
    </tr><tr class="opera no">
      <td>Opera</td>
      <td>No</td>
    </tr><tr class="opera_android no">
      <td>Opera Android</td>
      <td>No</td>
    </tr><tr class="safari no">
      <td>Safari</td>
      <td>No</td>
    </tr><tr class="safari_ios no">
      <td>Safari iOS</td>
      <td>No</td>
    </tr><tr class="samsunginternet_android no">
      <td>Samsung Internet</td>
      <td>No</td>
    </tr><tr class="webview_android no">
      <td>WebView Android</td>
      <td>No</td>
    </tr>
  </table>
  </details></aside><section id="name-attribute"><div class="header-wrapper"><h4 id="x5-3-2-name-attribute"><bdi class="secno">5.3.2 </bdi>
            <code>name</code> attribute
          </h4><a class="self-link" href="#name-attribute" aria-label="Permalink for Section 5.3.2"></a></div>
          
          <p>
            The <dfn data-export="" data-dfn-type="attribute" id="dom-permissionstatus-name" data-idl="attribute" data-title="name" data-dfn-for="PermissionStatus" data-type="DOMString" data-lt="name" data-local-lt="PermissionStatus.name" tabindex="0" aria-haspopup="dialog"><code>name</code></dfn> attribute returns the value it was initialized to.
          </p>
        </section>
        <aside class="mdn"><details>
    <summary aria-label="Expand MDN details for state"><span>MDN</span><span> </span></summary>
    <a title="The state read-only property of the PermissionStatus interface returns the state of a requested permission. This property returns one of 'granted', 'denied', or 'prompt'." href="https://developer.mozilla.org/en-US/docs/Web/API/PermissionStatus/state">PermissionStatus/state</a>
    
    <table>
    <tr class="chrome unknown">
      <td>Chrome</td>
      <td>?</td>
    </tr><tr class="chrome_android unknown">
      <td>Chrome Android</td>
      <td>?</td>
    </tr><tr class="edge no">
      <td>Edge</td>
      <td>No</td>
    </tr><tr class="edge_mobile unknown">
      <td>Edge Mobile</td>
      <td>?</td>
    </tr><tr class="firefox yes">
      <td>Firefox</td>
      <td>46+</td>
    </tr><tr class="firefox_android yes">
      <td>Firefox Android</td>
      <td>46+</td>
    </tr><tr class="ie no">
      <td>Internet Explorer</td>
      <td>No</td>
    </tr><tr class="opera unknown">
      <td>Opera</td>
      <td>?</td>
    </tr><tr class="opera_android unknown">
      <td>Opera Android</td>
      <td>?</td>
    </tr><tr class="safari no">
      <td>Safari</td>
      <td>No</td>
    </tr><tr class="safari_ios no">
      <td>Safari iOS</td>
      <td>No</td>
    </tr><tr class="samsunginternet_android yes">
      <td>Samsung Internet</td>
      <td>4.0+</td>
    </tr><tr class="webview_android no">
      <td>WebView Android</td>
      <td>No</td>
    </tr>
  </table>
  </details></aside><section id="state-attribute"><div class="header-wrapper"><h4 id="x5-3-3-state-attribute"><bdi class="secno">5.3.3 </bdi>
            <code>state</code> attribute
          </h4><a class="self-link" href="#state-attribute" aria-label="Permalink for Section 5.3.3"></a></div>
          
          <p>
            The <dfn data-export="" data-dfn-type="attribute" id="dom-permissionstatus-state" data-idl="attribute" data-title="state" data-dfn-for="PermissionStatus" data-type="PermissionState" data-lt="state" data-local-lt="PermissionStatus.state" tabindex="0" aria-haspopup="dialog"><code>state</code></dfn> attribute returns the latest value that was set on the current
            instance.
          </p>
        </section>
        <aside class="mdn"><details>
    <summary aria-label="Expand MDN details for onchange"><span>MDN</span><span> </span></summary>
    <a title="The onchange event handler of the PermissionStatus interface is called whenever the PermissionStatus.state property changes." href="https://developer.mozilla.org/en-US/docs/Web/API/PermissionStatus/onchange">PermissionStatus/onchange</a>
    
    <table>
    <tr class="chrome yes">
      <td>Chrome</td>
      <td>43+</td>
    </tr><tr class="chrome_android yes">
      <td>Chrome Android</td>
      <td>43+</td>
    </tr><tr class="edge no">
      <td>Edge</td>
      <td>No</td>
    </tr><tr class="edge_mobile unknown">
      <td>Edge Mobile</td>
      <td>?</td>
    </tr><tr class="firefox yes">
      <td>Firefox</td>
      <td>46+</td>
    </tr><tr class="firefox_android yes">
      <td>Firefox Android</td>
      <td>46+</td>
    </tr><tr class="ie no">
      <td>Internet Explorer</td>
      <td>No</td>
    </tr><tr class="opera yes">
      <td>Opera</td>
      <td>30+</td>
    </tr><tr class="opera_android yes">
      <td>Opera Android</td>
      <td>30+</td>
    </tr><tr class="safari no">
      <td>Safari</td>
      <td>No</td>
    </tr><tr class="safari_ios no">
      <td>Safari iOS</td>
      <td>No</td>
    </tr><tr class="samsunginternet_android yes">
      <td>Samsung Internet</td>
      <td>4.0+</td>
    </tr><tr class="webview_android no">
      <td>WebView Android</td>
      <td>No</td>
    </tr>
  </table>
  </details></aside><section id="onchange-attribute"><div class="header-wrapper"><h4 id="x5-3-4-onchange-attribute"><bdi class="secno">5.3.4 </bdi>
            <code>onchange</code> attribute
          </h4><a class="self-link" href="#onchange-attribute" aria-label="Permalink for Section 5.3.4"></a></div>
          
          <p>
            The <dfn data-export="" data-dfn-type="attribute" id="dom-permissionstatus-onchange" data-idl="attribute" data-title="onchange" data-dfn-for="PermissionStatus" data-type="EventHandler" data-lt="onchange" data-local-lt="PermissionStatus.onchange" tabindex="0" aria-haspopup="dialog"><code>onchange</code></dfn> attribute is an <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handler</a> whose corresponding
            <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a> is <code>change</code>.
          </p>
          <p id="PermissionStatus-update">
            Whenever the <a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#user-agent">user agent</a> is aware that the state of a <a data-link-type="idl" data-lt="PermissionStatus" href="#dom-permissionstatus" class="internalDFN" id="ref-for-dom-permissionstatus-7"><code>PermissionStatus</code></a> instance
            <var>status</var> has changed, it asynchronously runs the <dfn id="dfn-permissionstatus-update-steps" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><code>PermissionStatus</code> update
            steps</dfn>:
          </p>
          <ol class="algorithm">
            <li>Let <var>query</var> be <var>status</var>'s <a data-lt="[[query]]" href="#dfn-query" class="internalDFN" data-link-type="idl" id="ref-for-dfn-query-3"><code>[[query]]</code></a> internal slot.
            </li>
            <li>Run <var>query</var>'s <a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-11"><code>name</code></a>'s <a data-link-type="dfn" href="#dfn-permission-query-algorithm" class="internalDFN" id="ref-for-dfn-permission-query-algorithm-2">permission query algorithm</a>, passing <var>query</var> and <var>status</var>.
            </li>
            <li>
              <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> on the <dfn class="export" data-export="" id="dfn-permissions-task-source" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">permissions task source</dfn> to
              <a data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code>change</code> at <var>status</var>.
            </li>
          </ol>
        </section>
        <section id="garbage-collection"><div class="header-wrapper"><h4 id="permissionstatus-gc"><bdi class="secno">5.3.5 </bdi>
            Garbage collection
          </h4><a class="self-link" href="#permissionstatus-gc" aria-label="Permalink for Section 5.3.5"></a></div>
          
          <p>
            A <a data-link-type="idl" data-lt="PermissionStatus" href="#dom-permissionstatus" class="internalDFN" id="ref-for-dom-permissionstatus-8"><code>PermissionStatus</code></a> object <em class="rfc2119">MUST NOT</em> be garbage collected if it has an <a data-link-type="dfn" data-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-listener">event listener</a> whose type is <code>change</code>.
          </p>
        </section>
      </section>
    </section>
    <section id="conformance"><div class="header-wrapper"><h2 id="x6-conformance"><bdi class="secno">6. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 6."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">OPTIONAL</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>
    <section class="informative appendix" id="relationship-to-the-permissions-policy-specification"><div class="header-wrapper"><h2 id="relationship-to-permissions-policy"><bdi class="secno">A. </bdi>
        Relationship to the Permissions Policy specification
      </h2><a class="self-link" href="#relationship-to-permissions-policy" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        Although technically this specification and the <cite><a data-matched-text="[[[Permissions-Policy]]]" href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a></cite> specification deal
        with "permissions", each specification serves a distinct purpose in the platform.
        Nevertheless, the two specifications do explicitly overlap.
      </p>
      <p>
        On the one hand, this specification exclusively concerns itself with <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-29">powerful features</a>
        whose access is managed through a user-agent mediated permissions UI (i.e., permissions
        where the user gives express consent before that feature can be used, and where the user
        retains the ability to deny that permission at any time for any reason). These powerful
        features are registered in the <cite><a data-matched-text="[[[powerful-feature-registry]]]" href="https://w3c.github.io/powerful-features-registry/">Registry of Powerful Features</a></cite>.
      </p>
      <p>
        On the other hand, the <cite><a data-matched-text="[[[Permissions-Policy]]]" href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a></cite> specification allows developers to
        selectively enable and disable <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-30">powerful features</a> through a "<a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/dom.html#concept-document-permissions-policy">permissions policy</a>" (be it a HTTP header or a the <code><a data-type="element-attr" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-allow">allow</a></code> attribute). The APIs and features
        in scope for the <cite><a data-matched-text="[[[Permissions-Policy]]]" href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a></cite> specification go beyond those identified in the
        <cite><a data-matched-text="[[[powerful-feature-registry]]]" href="https://w3c.github.io/powerful-features-registry/">Registry of Powerful Features</a></cite> (e.g., "sync-xhr" and "gamepad"). In that sense, the
        Permissions Policy subsumes this specification in that <cite><a data-matched-text="[[[Permissions-Policy]]]" href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a></cite> governs
        whether a feature is available at all, independently of this specification.
      </p>
      <p>
        A powerful feature that has been disabled by the <cite><a data-matched-text="[[[Permissions-Policy]]]" href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a></cite> specification
        always has its <a data-link-type="dfn" href="#dfn-state" class="internalDFN" id="ref-for-dfn-state-15">permission state</a> reflected as "denied" by this specification. This
        occurs because <a data-link-type="dfn" data-lt="getting the current permission state" href="#dfn-getting-the-current-permission-state" class="internalDFN" id="ref-for-dfn-getting-the-current-permission-state-1">reading the current permission</a>
        relies on [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">HTML</a></cite>]'s "<a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use">allowed to use</a>" check, which itself calls into the
        <cite><a data-matched-text="[[[Permissions-Policy]]]" href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a></cite> specification. Important to note here is the sharing of permission
        names across both specifications. Both this specification and the <cite><a data-matched-text="[[[Permissions-Policy]]]" href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a></cite>
        specification rely on other specifications defining the names of the permission and
        <a data-link-type="dfn" href="#dfn-name" class="internalDFN" id="ref-for-dfn-name-2">name</a>, and they are usually named the same thing (e.g., "geolocation"
        of the <cite><a data-matched-text="[[[Geolocation]]]" href="https://www.w3.org/TR/geolocation/">Geolocation API</a></cite>, and so on).
      </p>
      <p>
        Finally, it's not possible for a powerful feature to ever become "granted" through any
        means provided by the <cite><a data-matched-text="[[[Permissions-Policy]]]" href="https://www.w3.org/TR/permissions-policy-1/">Permissions Policy</a></cite> specification. The only way that a
        <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-31">powerful feature</a> can be <a data-link-type="dfn" href="#dfn-granted" class="internalDFN" id="ref-for-dfn-granted-7">granted</a> is by the user giving <a data-link-type="dfn" href="#dfn-express-permission" class="internalDFN" id="ref-for-dfn-express-permission-8">express permission</a> or by some user agent policy.
      </p>
    </section>
    <section data-cite="WEBIDL webdriver" id="automated-testing"><div class="header-wrapper"><h2 id="automation"><bdi class="secno">B. </bdi>
        Automated testing
      </h2><a class="self-link" href="#automation" aria-label="Permalink for Section B."></a></div>
      
      <p>
        For the purposes of user-agent automation and application testing, this document defines
        the following <a data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-extension-commands">extension commands</a> for the [<cite><a class="bibref" data-link-type="biblio" href="#bib-webdriver" title="WebDriver">WebDriver</a></cite>] specification. It is <em class="rfc2119">OPTIONAL</em>
        for a user agent to support <a data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-extension-commands">extension commands</a> commands.
      </p>
      <pre class="idl def" id="webidl-1074251458"><span class="idlHeader"><a class="self-link" href="#webidl-1074251458">WebIDL</a></span><code><span data-idl="" class="idlDictionary" id="idl-def-permissionsetparameters" data-title="PermissionSetParameters">dictionary <dfn data-export="" data-dfn-type="dictionary" id="dom-permissionsetparameters" data-idl="dictionary" data-title="PermissionSetParameters" data-dfn-for="" class="idlID" tabindex="0" aria-haspopup="dialog"><code>PermissionSetParameters</code></dfn> {<span data-idl="" class="idlMember" id="idl-def-permissionsetparameters-descriptor" data-title="descriptor" data-dfn-for="PermissionSetParameters">
  required<span class="idlType"> <a href="#dom-permissiondescriptor" class="internalDFN" data-link-type="idl" id="ref-for-dom-permissiondescriptor-13"><code>PermissionDescriptor</code></a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-permissionsetparameters-descriptor" data-idl="field" data-title="descriptor" data-dfn-for="PermissionSetParameters" data-type="PermissionDescriptor" class="idlName" tabindex="0" aria-haspopup="dialog"><code>descriptor</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-permissionsetparameters-state" data-title="state" data-dfn-for="PermissionSetParameters">
  required<span class="idlType"> <a href="#dom-permissionstate" class="internalDFN" data-link-type="idl" id="ref-for-dom-permissionstate-7"><code>PermissionState</code></a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-permissionsetparameters-state" data-idl="field" data-title="state" data-dfn-for="PermissionSetParameters" data-type="PermissionState" class="idlName" tabindex="0" aria-haspopup="dialog"><code>state</code></dfn>;</span><span data-idl="" class="idlMember" id="idl-def-permissionsetparameters-onerealm" data-title="oneRealm" data-dfn-for="PermissionSetParameters"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <dfn data-export="" data-dfn-type="dict-member" id="dom-permissionsetparameters-onerealm" data-idl="field" data-title="oneRealm" data-dfn-for="PermissionSetParameters" data-type="boolean" class="idlName" tabindex="0" aria-haspopup="dialog"><code>oneRealm</code></dfn> = false;</span>
};</span></code></pre>
      <section id="set-permission"><div class="header-wrapper"><h3 id="set-permission-command"><bdi class="secno">B.1 </bdi>
          Set Permission
        </h3><a class="self-link" href="#set-permission-command" aria-label="Permalink for Section B.1"></a></div>
        
        <table>
          <tbody>
            <tr>
              <th>
                HTTP Method
              </th>
              <th>
                <a data-lt="extension command URI template" data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-extension-command-uri-template">URI Template</a>
              </th>
            </tr>
            <tr>
              <td>
                POST
              </td>
              <td>
                /session/{session id}/permissions
              </td>
            </tr>
          </tbody>
        </table>
        <p>
          The <dfn id="dfn-set-permission" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Set Permission</dfn> <a data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-extension-commands">extension command</a> simulates user modification of a
          <a data-link-type="idl" data-lt="PermissionDescriptor" href="#dom-permissiondescriptor" class="internalDFN" id="ref-for-dom-permissiondescriptor-14"><code>PermissionDescriptor</code></a>'s <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-16">permission state</a>.
        </p>
        <p>
          The <a data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-remote-end-steps">remote end steps</a> are:
        </p>
        <ol>
          <li>Let <var>parameters</var> be the <var>parameters</var> argument, <a data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-convert-ecmascript-to-idl-value">converted to an IDL value</a> of
          type <a data-link-type="idl" data-lt="PermissionSetParameters" href="#dom-permissionsetparameters" class="internalDFN" id="ref-for-dom-permissionsetparameters-1"><code>PermissionSetParameters</code></a>. If this throws an exception, return a <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-invalid-argument">invalid argument</a> <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-error">error</a>.
          </li>
          <li>Let <var>rootDesc</var> be <var>parameters</var>.<a data-link-type="idl" href="#dom-permissionsetparameters-descriptor" class="internalDFN" id="ref-for-dom-permissionsetparameters-descriptor-1"><code>descriptor</code></a>.
          </li>
          <li>Let <var>typedDescriptor</var> be the object <var>rootDesc</var> refers to, <a data-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-convert-ecmascript-to-idl-value">converted to an IDL
          value</a> of <code><var>rootDesc</var>.<a data-link-type="idl" href="#dom-permissiondescriptor-name" class="internalDFN" id="ref-for-dom-permissiondescriptor-name-12"><code>name</code></a></code>'s <a data-link-type="dfn" href="#dfn-permission-descriptor-type" class="internalDFN" id="ref-for-dfn-permission-descriptor-type-5">permission descriptor type</a>. If this throws an exception, return a <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-invalid-argument">invalid argument</a> <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-error">error</a>.
          </li>
          <li>If <var>parameters</var>.<a data-link-type="idl" href="#dom-permissionsetparameters-state" class="internalDFN" id="ref-for-dom-permissionsetparameters-state-1"><code>state</code></a> is an inappropriate <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-17">permission
          state</a> for any implementation-defined reason, return a <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-invalid-argument">invalid argument</a> <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-error">error</a>.
            <div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-6" aria-level="4"><span>Note</span></div><p class="">
              For example, <a data-type="dfn" href="https://infra.spec.whatwg.org/#user-agent">user agents</a> that define the "midi" <a href="#dfn-powerful-feature" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-powerful-feature-32">powerful feature</a> as
              "always on" may choose to reject command to set the <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-18">permission state</a> to
              "<a data-link-type="idl" href="#dom-permissionstate-denied" class="internalDFN" id="ref-for-dom-permissionstate-denied-13"><code>denied</code></a>" at this step.
            </p></div>
          </li>
          <li>Let <var>settings</var> be the <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object">current settings object</a>.
          </li>
          <li>If <var>parameters</var>.<a data-link-type="idl" href="#dom-permissionsetparameters-onerealm" class="internalDFN" id="ref-for-dom-permissionsetparameters-onerealm-1"><code>oneRealm</code></a> is true, let <var>targets</var> be a <a data-type="dfn" href="https://infra.spec.whatwg.org/#list">
            list</a> whose sole member is <var>settings</var>.
          </li>
          <li>Otherwise, let <var>targets</var> be a <a data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a> containing all <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings
          objects</a> whose <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">origin</a> is the <a data-lt="same origin" data-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#same-origin">
            same</a> as the <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin">origin</a> of <var>settings</var>.
          </li>
          <li>Let <var>tasks</var> be an empty <a data-type="dfn" href="https://infra.spec.whatwg.org/#list">list</a>.
          </li>
          <li>For each <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object">environment settings object</a> <var>target</var> in <var>targets</var>:
            <ol>
              <li>
                <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> <var>task</var> on the <a href="#dfn-permissions-task-source" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-permissions-task-source-2">permissions task source</a> of <var>target</var>'s
                <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">relevant settings object</a>'s <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global">global object</a>'s
                <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/window-object.html#window-bc">browsing context</a> to perform the following step:
                <ol>
                  <li>Interpret <var>parameters</var>.<a data-link-type="idl" href="#dom-permissionsetparameters-state" class="internalDFN" id="ref-for-dom-permissionsetparameters-state-2"><code>state</code></a> as if it were the
                  result of an invocation of <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-19">permission state</a> for <var>typedDescriptor</var> with the
                  argument <var>target</var> made at this moment.
                  </li>
                </ol>
              </li>
              <li><a data-link-type="dfn" data-type="dfn" href="https://infra.spec.whatwg.org/#list-append">Append</a> <var>task</var> to <var>tasks</var>.
              </li>
            </ol>
          </li>
          <li>Wait for all <a data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-task">tasks</a> in <var>tasks</var> to have executed.
          </li>
          <li>Return <a data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-success">success</a> with data <code>null</code>.
          </li>
        </ol>
        <aside class="example" id="example-setting-a-permission-via-webdriver"><div class="marker">
    <a class="self-link" href="#example-setting-a-permission-via-webdriver">Example<bdi> 5</bdi></a><span class="example-title">: Setting a permission via WebDriver</span>
  </div>
          <p>
            To <a data-link-type="dfn" href="#dfn-set-permission" class="internalDFN" id="ref-for-dfn-set-permission-1">set permission</a> for <code>{name: "midi", sysex: true}</code> of the <a data-link-type="dfn" data-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object">current settings object</a> of the <a data-type="dfn" href="https://www.w3.org/TR/webdriver1/#dfn-session">session</a> with ID 23 to "<code>granted</code>", the local end would POST to
            <code>/session/23/permissions</code> with the body:
          </p>
          <pre class="lang-json" aria-busy="false"><code class="hljs">{
  "descriptor": {
    "name": "midi",
    "sysex": true
  },
  "state": "granted"
}</code></pre>
        </aside>
      </section>
    </section>
    <section class="appendix" id="privacy-considerations-0"><div class="header-wrapper"><h2 id="privacy-considerations"><bdi class="secno">C. </bdi>
        Privacy considerations
      </h2><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Appendix C."></a></div>
      
      <p>
        An adversary could use a <a href="#dfn-state" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-state-20">permission state</a> as an element in creating a "fingerprint"
        corresponding to an end-user. Although an adversary can already determine the state of a
        permission by actually using the API, that often leads to a UI prompt being presented to
        the end-user (if the permission was not already <a data-link-type="dfn" href="#dfn-granted" class="internalDFN" id="ref-for-dfn-granted-8">granted</a>). Even though this
        API doesn't expose new fingerprinting information to websites, it makes it easier for an
        adversary to have discreet access to this information.
      </p>
      <p>
        A user agent <em class="rfc2119">SHOULD</em> provide a means for the user to review, update, and reset the
        <a data-link-type="dfn" href="#dfn-permission" class="internalDFN" id="ref-for-dfn-permission-10">permission</a> <a data-link-type="dfn" href="#dfn-states" class="internalDFN" id="ref-for-dfn-states-3">state</a> of <a data-link-type="dfn" href="#dfn-powerful-feature" class="internalDFN" id="ref-for-dfn-powerful-feature-33">powerful features</a> associated with a realm or
        origin.
      </p>
    </section>
    <section id="security-considerations"><div class="header-wrapper"><h2 id="d-security-considerations"><bdi class="secno">D. </bdi>
        Security considerations
      </h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section D."></a></div>
      
      <p>
        There are no documented security considerations at this time. Readers are instead
        encouraged to read section <a href="#privacy-considerations" data-matched-text="[[[#privacy-considerations]]]" class="sec-ref"><bdi class="secno">C. </bdi>
        Privacy considerations</a>.
      </p>
    </section>
    <section id="idl-index"><div class="header-wrapper"><h2 id="e-idl-index"><bdi class="secno">E. </bdi>IDL Index</h2><a class="self-link" href="#idl-index" aria-label="Permalink for Section E."></a></div><pre class="idl def" id="actual-idl-index"><span class="idlHeader"><a class="self-link" href="#actual-idl-index">WebIDL</a></span><code><span data-idl="" class="idlInterface" data-title="Navigator">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window)</span>]
partial interface <a data-idl="partial" data-link-type="interface" data-title="Navigator" class="idlID" data-dfn-for="Navigator" data-type="interface" href="https://html.spec.whatwg.org/multipage/system-state.html#navigator">Navigator</a> {<span data-idl="" class="idlAttribute" data-title="permissions" data-dfn-for="Navigator">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject">SameObject</a></span>] readonly attribute<span class="idlType"> <a href="#dfn-permission" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-permission-11">Permissions</a></span> <dfn data-export="" data-dfn-type="attribute" data-idl="attribute" data-title="permissions" data-dfn-for="Navigator" data-type="Permissions" data-lt="permissions" data-local-lt="Navigator.permissions" class="idlName"><code>permissions</code></dfn>;</span>
};</span><span data-idl="" class="idlInterface" data-title="WorkerNavigator">

[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Worker)</span>]
partial interface <a data-idl="partial" data-link-type="interface" data-title="WorkerNavigator" class="idlID" data-dfn-for="WorkerNavigator" data-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workernavigator">WorkerNavigator</a> {<span data-idl="" class="idlAttribute" data-title="permissions" data-dfn-for="WorkerNavigator">
  [<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject">SameObject</a></span>] readonly attribute<span class="idlType"> <a href="#dfn-permission" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-permission-12">Permissions</a></span> <dfn data-export="" data-dfn-type="attribute" data-idl="attribute" data-title="permissions" data-dfn-for="WorkerNavigator" data-type="Permissions" data-lt="permissions" data-local-lt="WorkerNavigator.permissions" class="idlName"><code>permissions</code></dfn>;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="Permissions">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window,Worker)</span>]
interface <dfn data-export="" data-dfn-type="interface" data-idl="interface" data-title="Permissions" data-dfn-for="" class="idlID"><code>Permissions</code></dfn> {<span data-idl="" class="idlMethod" data-title="query" data-dfn-for="Permissions"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise">Promise</a>&lt;<a href="#dom-permissionstatus" class="internalDFN" data-link-type="idl" id="ref-for-dom-permissionstatus-9"><code>PermissionStatus</code></a>&gt;</span> <a class="internalDFN idlName" data-link-type="method" href="#dom-permissions-query" id="ref-for-dom-permissions-query-3"><code>query</code></a>(<span class="idlType"><a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-object">object</a></span> <span class="idlParamName">permissionDesc</span>);</span>
};</span><span data-idl="" class="idlDictionary" data-title="PermissionDescriptor">

dictionary <dfn data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="PermissionDescriptor" data-dfn-for="" class="idlID"><code>PermissionDescriptor</code></dfn> {<span data-idl="" class="idlMember" data-title="name" data-dfn-for="PermissionDescriptor">
  required<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <dfn data-export="" data-dfn-type="dict-member" data-idl="field" data-title="name" data-dfn-for="PermissionDescriptor" data-type="DOMString" class="idlName"><code>name</code></dfn>;</span>
};</span>

<span data-idl="" class="idlInterface" data-title="PermissionStatus">[<span class="extAttr"><a data-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed">Exposed</a>=(Window,Worker)</span>]
interface <dfn data-export="" data-dfn-type="interface" data-idl="interface" data-title="PermissionStatus" data-dfn-for="" class="idlID"><code>PermissionStatus</code></dfn> : <span class="idlSuperclass"><a data-type="interface" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a></span> {<span data-idl="" class="idlAttribute" data-title="state" data-dfn-for="PermissionStatus">
  readonly attribute<span class="idlType"> <a href="#dom-permissionstate" class="internalDFN" data-link-type="idl" id="ref-for-dom-permissionstate-8"><code>PermissionState</code></a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-permissionstatus-state" id="ref-for-dom-permissionstatus-state-3"><code>state</code></a>;</span><span data-idl="" class="idlAttribute" data-title="name" data-dfn-for="PermissionStatus">
  readonly attribute<span class="idlType"> <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString">DOMString</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-permissionstatus-name" id="ref-for-dom-permissionstatus-name-3"><code>name</code></a>;</span><span data-idl="" class="idlAttribute" data-title="onchange" data-dfn-for="PermissionStatus">
  attribute<span class="idlType"> <a data-type="typedef" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a></span> <a class="internalDFN idlName" data-link-type="attribute" href="#dom-permissionstatus-onchange" id="ref-for-dom-permissionstatus-onchange-2"><code>onchange</code></a>;</span>
};</span><span data-idl="" class="idlEnum" data-title="PermissionState">

enum <dfn data-export="" data-dfn-type="enum" data-idl="enum" data-title="PermissionState" data-dfn-for="" class="idlID"><code>PermissionState</code></dfn> {
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-permissionstate-granted" id="ref-for-dom-permissionstate-granted-7"><code>granted</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-permissionstate-denied" id="ref-for-dom-permissionstate-denied-14"><code>denied</code></a>"</span>,
  <span class="idlEnumItem">"<a class="internalDFN" data-link-type="enum-value" href="#dom-permissionstate-prompt" id="ref-for-dom-permissionstate-prompt-4"><code>prompt</code></a>"</span>,
};</span>

<span data-idl="" class="idlDictionary" data-title="PermissionSetParameters">dictionary <dfn data-export="" data-dfn-type="dictionary" data-idl="dictionary" data-title="PermissionSetParameters" data-dfn-for="" class="idlID"><code>PermissionSetParameters</code></dfn> {<span data-idl="" class="idlMember" data-title="descriptor" data-dfn-for="PermissionSetParameters">
  required<span class="idlType"> <a href="#dom-permissiondescriptor" class="internalDFN" data-link-type="idl" id="ref-for-dom-permissiondescriptor-15"><code>PermissionDescriptor</code></a></span> <dfn data-export="" data-dfn-type="dict-member" data-idl="field" data-title="descriptor" data-dfn-for="PermissionSetParameters" data-type="PermissionDescriptor" class="idlName"><code>descriptor</code></dfn>;</span><span data-idl="" class="idlMember" data-title="state" data-dfn-for="PermissionSetParameters">
  required<span class="idlType"> <a href="#dom-permissionstate" class="internalDFN" data-link-type="idl" id="ref-for-dom-permissionstate-9"><code>PermissionState</code></a></span> <dfn data-export="" data-dfn-type="dict-member" data-idl="field" data-title="state" data-dfn-for="PermissionSetParameters" data-type="PermissionState" class="idlName"><code>state</code></dfn>;</span><span data-idl="" class="idlMember" data-title="oneRealm" data-dfn-for="PermissionSetParameters"><span class="idlType">
  <a data-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean">boolean</a></span> <dfn data-export="" data-dfn-type="dict-member" data-idl="field" data-title="oneRealm" data-dfn-for="PermissionSetParameters" data-type="boolean" class="idlName"><code>oneRealm</code></dfn> = false;</span>
};</span></code></pre></section>
    <section class="appendix informative" id="acknowledgments"><div class="header-wrapper"><h2 class="no-num" id="f-acknowledgments"><bdi class="secno">F. </bdi>
        Acknowledgments
      </h2><a class="self-link" href="#acknowledgments" aria-label="Permalink for Appendix F."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
        The editors would like to thank Adrienne Porter Felt, Anne van Kesteren, Domenic Denicola,
        Jake Archibald and Wendy Seltzer for their help with the API design and editorial work.
      </p>
    </section>
  

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="g-references"><bdi class="secno">G. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix G."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="g-1-normative-references"><bdi class="secno">G.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix G.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-dom">[dom]</dt><dd>
      <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
    </dd><dt id="bib-html">[HTML]</dt><dd>
      <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
    </dd><dt id="bib-infra">[infra]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-permissions-policy">[Permissions-Policy]</dt><dd>
      <a href="https://www.w3.org/TR/permissions-policy-1/"><cite>Permissions Policy</cite></a>. Ian Clelland.  W3C. 16 July 2020. W3C Working Draft. URL: <a href="https://www.w3.org/TR/permissions-policy-1/">https://www.w3.org/TR/permissions-policy-1/</a>
    </dd><dt id="bib-powerful-feature-registry">[powerful-feature-registry]</dt><dd>
      <a href="https://w3c.github.io/powerful-features-registry/"><cite>Registry of Powerful Features</cite></a>. unofficial. URL: <a href="https://w3c.github.io/powerful-features-registry/">https://w3c.github.io/powerful-features-registry/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-webdriver">[WebDriver]</dt><dd>
      <a href="https://www.w3.org/TR/webdriver1/"><cite>WebDriver</cite></a>. Simon Stewart; David Burns.  W3C. 5 June 2018. W3C Recommendation. URL: <a href="https://www.w3.org/TR/webdriver1/">https://www.w3.org/TR/webdriver1/</a>
    </dd><dt id="bib-webidl">[WEBIDL]</dt><dd>
      <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Edgar Chen; Timothy Gu.  WHATWG. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="g-2-informative-references"><bdi class="secno">G.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix G.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-appmanifest">[appmanifest]</dt><dd>
      <a href="https://www.w3.org/TR/appmanifest/"><cite>Web Application Manifest</cite></a>. Marcos Caceres; Kenneth Christiansen; Matt Giuca; Aaron Gustafson; Daniel Murphy; Anssi Kostiainen.  W3C. 17 February 2022. W3C Working Draft. URL: <a href="https://www.w3.org/TR/appmanifest/">https://www.w3.org/TR/appmanifest/</a>
    </dd><dt id="bib-ecmascript">[ecmascript]</dt><dd>
      <a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>.  Ecma International. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
    </dd><dt id="bib-geolocation">[Geolocation]</dt><dd>
      <a href="https://www.w3.org/TR/geolocation/"><cite>Geolocation API</cite></a>. Marcos Caceres; Reilly Grant.  W3C. 21 February 2022. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/geolocation/">https://www.w3.org/TR/geolocation/</a>
    </dd><dt id="bib-getusermedia">[GETUSERMEDIA]</dt><dd>
      <a href="https://www.w3.org/TR/mediacapture-streams/"><cite>Media Capture and Streams</cite></a>. Cullen Jennings; Bernard Aboba; Jan-Ivar Bruaroey; Henrik Boström; youenn fablet.  W3C. 10 February 2022. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/mediacapture-streams/">https://www.w3.org/TR/mediacapture-streams/</a>
    </dd><dt id="bib-notifications">[notifications]</dt><dd>
      <a href="https://notifications.spec.whatwg.org/"><cite>Notifications API Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://notifications.spec.whatwg.org/">https://notifications.spec.whatwg.org/</a>
    </dd><dt id="bib-push-api">[push-api]</dt><dd>
      <a href="https://www.w3.org/TR/push-api/"><cite>Push API</cite></a>. Peter Beverloo; Martin Thomson.  W3C. 3 November 2021. W3C Working Draft. URL: <a href="https://www.w3.org/TR/push-api/">https://www.w3.org/TR/push-api/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permission" aria-label="Links in this document to definition: permission">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permission" aria-label="Permalink for definition: permission. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-permission-1" title="§ 2. Model">§ 2. Model</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-2" title="§ 2.1 Permissions">§ 2.1 Permissions</a> <a href="#ref-for-dfn-permission-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-4" title="§ 2.2 Powerful features">§ 2.2 Powerful features</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-5" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-permission-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-permission-7" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-8" title="§ 5.1 Extensions to the Navigator and WorkerNavigator interfaces">§ 5.1 Extensions to the Navigator and WorkerNavigator interfaces</a> <a href="#ref-for-dfn-permission-9" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-10" title="§ C. Privacy considerations">§ C. Privacy considerations</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-11" title="§ E. IDL Index">§ E. IDL Index</a> <a href="#ref-for-dfn-permission-12" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-express-permission" aria-label="Links in this document to definition: Express permission">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-express-permission" aria-label="Permalink for definition: Express permission. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-express-permission-1" title="§ 2.1 Permissions">§ 2.1 Permissions</a> <a href="#ref-for-dfn-express-permission-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-express-permission-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-express-permission-4" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-express-permission-5" title="§ 2.2 Powerful features">§ 2.2 Powerful features</a> 
  </li><li>
    <a href="#ref-for-dfn-express-permission-6" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> <a href="#ref-for-dfn-express-permission-7" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-express-permission-8" title="§ A. Relationship to the Permissions Policy specification">§ A. Relationship to the Permissions Policy specification</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-states" aria-label="Links in this document to definition: states">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-states" aria-label="Permalink for definition: states. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-states-1" title="§ 2.1 Permissions">§ 2.1 Permissions</a> <a href="#ref-for-dfn-states-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-states-3" title="§ C. Privacy considerations">§ C. Privacy considerations</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-denied" aria-label="Links in this document to definition: Denied">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-denied" aria-label="Permalink for definition: Denied. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-denied-1" title="§ 2.1 Permissions">§ 2.1 Permissions</a> <a href="#ref-for-dfn-denied-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-denied-3" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-granted" aria-label="Links in this document to definition: Granted">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-granted" aria-label="Permalink for definition: Granted. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-granted-1" title="§ 2.1 Permissions">§ 2.1 Permissions</a> <a href="#ref-for-dfn-granted-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-granted-3" title="§ 2.2 Powerful features">§ 2.2 Powerful features</a> <a href="#ref-for-dfn-granted-4" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-granted-5" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-granted-6" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dfn-granted-7" title="§ A. Relationship to the Permissions Policy specification">§ A. Relationship to the Permissions Policy specification</a> 
  </li><li>
    <a href="#ref-for-dfn-granted-8" title="§ C. Privacy considerations">§ C. Privacy considerations</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-prompt" aria-label="Links in this document to definition: Prompt">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-prompt" aria-label="Permalink for definition: Prompt. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-prompt-1" title="§ 2.1 Permissions">§ 2.1 Permissions</a> 
  </li><li>
    <a href="#ref-for-dfn-prompt-2" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-prompt-3" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-new-information-about-the-user-s-intent" aria-label="Links in this document to definition: new information about the user's intent">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-new-information-about-the-user-s-intent" aria-label="Permalink for definition: new information about the user's intent. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-new-information-about-the-user-s-intent-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-new-information-about-the-user-s-intent-2" title="§ 4.1 Reading the current permission state">§ 4.1 Reading the current permission state</a> 
  </li><li>
    <a href="#ref-for-dfn-new-information-about-the-user-s-intent-3" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-new-information-about-the-user-s-intent-4" title="§ 4.3 Prompt the user to choose">§ 4.3 Prompt the user to choose</a> <a href="#ref-for-dfn-new-information-about-the-user-s-intent-5" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-implicit-signals" aria-label="Links in this document to definition: implicit signals">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-implicit-signals" aria-label="Permalink for definition: implicit signals. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-implicit-signals-1" title="§ 2.1 Permissions">§ 2.1 Permissions</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-lifetime" aria-label="Links in this document to definition: lifetime">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-lifetime" aria-label="Permalink for definition: lifetime. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-lifetime-1" title="§ 2.1 Permissions">§ 2.1 Permissions</a> <a href="#ref-for-dfn-lifetime-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-lifetime-3" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-lifetime-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-lifetime-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-lifetime-6" title="Reference 4">(4)</a> <a href="#ref-for-dfn-lifetime-7" title="Reference 5">(5)</a> <a href="#ref-for-dfn-lifetime-8" title="Reference 6">(6)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-default-state" aria-label="Links in this document to definition: default state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-default-state" aria-label="Permalink for definition: default state. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-default-state-1" title="§ 2.1 Permissions">§ 2.1 Permissions</a> 
  </li><li>
    <a href="#ref-for-dfn-default-state-2" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-default-state-3" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-powerful-feature" aria-label="Links in this document to definition: powerful feature">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-powerful-feature" aria-label="Permalink for definition: powerful feature. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-powerful-feature-1" title="§ 1. Examples of usage">§ 1. Examples of usage</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-2" title="§ 2. Model">§ 2. Model</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-3" title="§ 2.1 Permissions">§ 2.1 Permissions</a> <a href="#ref-for-dfn-powerful-feature-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-powerful-feature-5" title="Reference 3">(3)</a> <a href="#ref-for-dfn-powerful-feature-6" title="Reference 4">(4)</a> <a href="#ref-for-dfn-powerful-feature-7" title="Reference 5">(5)</a> <a href="#ref-for-dfn-powerful-feature-8" title="Reference 6">(6)</a> <a href="#ref-for-dfn-powerful-feature-9" title="Reference 7">(7)</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-10" title="§ 2.2 Powerful features">§ 2.2 Powerful features</a> <a href="#ref-for-dfn-powerful-feature-11" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-12" title="§ 2.2.1 Aspects">§ 2.2.1 Aspects</a> <a href="#ref-for-dfn-powerful-feature-13" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-14" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-powerful-feature-15" title="Reference 2">(2)</a> <a href="#ref-for-dfn-powerful-feature-16" title="Reference 3">(3)</a> <a href="#ref-for-dfn-powerful-feature-17" title="Reference 4">(4)</a> <a href="#ref-for-dfn-powerful-feature-18" title="Reference 5">(5)</a> <a href="#ref-for-dfn-powerful-feature-19" title="Reference 6">(6)</a> <a href="#ref-for-dfn-powerful-feature-20" title="Reference 7">(7)</a> <a href="#ref-for-dfn-powerful-feature-21" title="Reference 8">(8)</a> <a href="#ref-for-dfn-powerful-feature-22" title="Reference 9">(9)</a> <a href="#ref-for-dfn-powerful-feature-23" title="Reference 10">(10)</a> <a href="#ref-for-dfn-powerful-feature-24" title="Reference 11">(11)</a> <a href="#ref-for-dfn-powerful-feature-25" title="Reference 12">(12)</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-26" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-27" title="§ 4.4 Reacting to users revoking permission">§ 4.4 Reacting to users revoking permission</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-28" title="§ 5.3.1 Creating instances">§ 5.3.1 Creating instances</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-29" title="§ A. Relationship to the Permissions Policy specification">§ A. Relationship to the Permissions Policy specification</a> <a href="#ref-for-dfn-powerful-feature-30" title="Reference 2">(2)</a> <a href="#ref-for-dfn-powerful-feature-31" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-32" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li><li>
    <a href="#ref-for-dfn-powerful-feature-33" title="§ C. Privacy considerations">§ C. Privacy considerations</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-name" aria-label="Links in this document to definition: name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-name" aria-label="Permalink for definition: name. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-name-1" title="§ 4.1 Reading the current permission state">§ 4.1 Reading the current permission state</a> 
  </li><li>
    <a href="#ref-for-dfn-name-2" title="§ A. Relationship to the Permissions Policy specification">§ A. Relationship to the Permissions Policy specification</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-aspects" aria-label="Links in this document to definition: aspects">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-aspects" aria-label="Permalink for definition: aspects. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-aspects-1" title="§ 2.2.1 Aspects">§ 2.2.1 Aspects</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-specifies-a-powerful-feature" aria-label="Links in this document to definition: specifies a powerful feature">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-specifies-a-powerful-feature" aria-label="Permalink for definition: specifies a powerful feature. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permission-descriptor-type" aria-label="Links in this document to definition: permission descriptor type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permission-descriptor-type" aria-label="Permalink for definition: permission descriptor type. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-permission-descriptor-type-1" title="§ 2.2.1 Aspects">§ 2.2.1 Aspects</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-descriptor-type-2" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-descriptor-type-3" title="§ 5.2.1 query() method">§ 5.2.1 query() method</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-descriptor-type-4" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-descriptor-type-5" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-stronger-than" aria-label="Links in this document to definition: stronger than">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-stronger-than" aria-label="Permalink for definition: stronger than. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-stronger-than-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permission-state-constraints" aria-label="Links in this document to definition: permission state constraints">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permission-state-constraints" aria-label="Permalink for definition: permission state constraints. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-permission-state-constraints-1" title="§ 4.1 Reading the current permission state">§ 4.1 Reading the current permission state</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-extra-permission-data-type" aria-label="Links in this document to definition: extra permission data type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-extra-permission-data-type" aria-label="Permalink for definition: extra permission data type. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-extra-permission-data-type-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-extra-permission-data-type-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-extra-permission-data" aria-label="Links in this document to definition: extra permission data">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-extra-permission-data" aria-label="Permalink for definition: extra permission data. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-extra-permission-data-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-extra-permission-data-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-extra-permission-data-3" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-extra-permission-data-constraints" aria-label="Links in this document to definition: extra permission data constraints">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-extra-permission-data-constraints" aria-label="Permalink for definition: extra permission data constraints. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-extra-permission-data-constraints-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permission-result-type" aria-label="Links in this document to definition: permission result type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permission-result-type" aria-label="Permalink for definition: permission result type. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-permission-result-type-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-permission-result-type-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-result-type-3" title="§ 5.3.1 Creating instances">§ 5.3.1 Creating instances</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permission-query-algorithm" aria-label="Links in this document to definition: permission query algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permission-query-algorithm" aria-label="Permalink for definition: permission query algorithm. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-permission-query-algorithm-1" title="§ 5.2.1 query() method">§ 5.2.1 query() method</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-query-algorithm-2" title="§ 5.3.4 onchange attribute">§ 5.3.4 onchange attribute</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-default-permission-query-algorithm" aria-label="Links in this document to definition: default permission query algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-default-permission-query-algorithm" aria-label="Permalink for definition: default permission query algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-default-permission-query-algorithm-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permission-revocation-algorithm" aria-label="Links in this document to definition: permission revocation algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permission-revocation-algorithm" aria-label="Permalink for definition: permission revocation algorithm. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-permission-revocation-algorithm-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-permission-revocation-algorithm-2" title="§ 4.4 Reacting to users revoking permission">§ 4.4 Reacting to users revoking permission</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-default-permission-state" aria-label="Links in this document to definition: Default permission state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-default-permission-state" aria-label="Permalink for definition: Default permission state. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-default-powerful-feature" aria-label="Links in this document to definition: default powerful feature">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-default-powerful-feature" aria-label="Permalink for definition: default powerful feature. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-getting-the-current-permission-state" aria-label="Links in this document to definition: get the current permission state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-getting-the-current-permission-state" aria-label="Permalink for definition: get the current permission state. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-getting-the-current-permission-state-1" title="§ A. Relationship to the Permissions Policy specification">§ A. Relationship to the Permissions Policy specification</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-state" aria-label="Links in this document to definition: permission state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-state" aria-label="Permalink for definition: permission state. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-state-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-state-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-state-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-state-5" title="Reference 5">(5)</a> <a href="#ref-for-dfn-state-6" title="Reference 6">(6)</a> <a href="#ref-for-dfn-state-7" title="Reference 7">(7)</a> <a href="#ref-for-dfn-state-8" title="Reference 8">(8)</a> 
  </li><li>
    <a href="#ref-for-dfn-state-9" title="§ 4.1 Reading the current permission state">§ 4.1 Reading the current permission state</a> <a href="#ref-for-dfn-state-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-11" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-state-12" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-state-13" title="§ 4.3 Prompt the user to choose">§ 4.3 Prompt the user to choose</a> <a href="#ref-for-dfn-state-14" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-state-15" title="§ A. Relationship to the Permissions Policy specification">§ A. Relationship to the Permissions Policy specification</a> 
  </li><li>
    <a href="#ref-for-dfn-state-16" title="§ B.1 Set Permission">§ B.1 Set Permission</a> <a href="#ref-for-dfn-state-17" title="Reference 2">(2)</a> <a href="#ref-for-dfn-state-18" title="Reference 3">(3)</a> <a href="#ref-for-dfn-state-19" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-state-20" title="§ C. Privacy considerations">§ C. Privacy considerations</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-request-permission-to-use" aria-label="Links in this document to definition: request permission to use">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-request-permission-to-use" aria-label="Permalink for definition: request permission to use. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-request-permission-to-use-1" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> <a href="#ref-for-dfn-request-permission-to-use-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-prompt-the-user-to-choose" aria-label="Links in this document to definition: prompt the user to choose">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-prompt-the-user-to-choose" aria-label="Permalink for definition: prompt the user to choose. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-prompt-the-user-to-choose-1" title="§ 4.3 Prompt the user to choose">§ 4.3 Prompt the user to choose</a> <a href="#ref-for-dfn-prompt-the-user-to-choose-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-prompt-the-user-to-choose-3" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-react-to-the-user-revoking-permission" aria-label="Links in this document to definition: react to the user revoking permission">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-react-to-the-user-revoking-permission" aria-label="Permalink for definition: react to the user revoking permission. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-react-to-the-user-revoking-permission-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dfn-react-to-the-user-revoking-permission-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-navigator-permissions" aria-label="Links in this document to definition: permissions">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-navigator-permissions" aria-label="Permalink for definition: permissions. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-workernavigator-permissions" aria-label="Links in this document to definition: permissions">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-workernavigator-permissions" aria-label="Permalink for definition: permissions. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissions" aria-label="Links in this document to definition: Permissions">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissions" aria-label="Permalink for definition: Permissions. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissions-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissiondescriptor" aria-label="Links in this document to definition: PermissionDescriptor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissiondescriptor" aria-label="Permalink for definition: PermissionDescriptor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissiondescriptor-1" title="§ 2.2.1 Aspects">§ 2.2.1 Aspects</a> <a href="#ref-for-dom-permissiondescriptor-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-3" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dom-permissiondescriptor-4" title="Reference 2">(2)</a> <a href="#ref-for-dom-permissiondescriptor-5" title="Reference 3">(3)</a> <a href="#ref-for-dom-permissiondescriptor-6" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-7" title="§ 4.1 Reading the current permission state">§ 4.1 Reading the current permission state</a> <a href="#ref-for-dom-permissiondescriptor-8" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-9" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-10" title="§ 4.3 Prompt the user to choose">§ 4.3 Prompt the user to choose</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-11" title="§ 5.2.1 query() method">§ 5.2.1 query() method</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-12" title="§ 5.3.1 Creating instances">§ 5.3.1 Creating instances</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-13" title="§ B. Automated testing">§ B. Automated testing</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-14" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-15" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissiondescriptor-name" aria-label="Links in this document to definition: name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissiondescriptor-name" aria-label="Permalink for definition: name. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissiondescriptor-name-1" title="§ 4.1 Reading the current permission state">§ 4.1 Reading the current permission state</a> <a href="#ref-for-dom-permissiondescriptor-name-2" title="Reference 2">(2)</a> <a href="#ref-for-dom-permissiondescriptor-name-3" title="Reference 3">(3)</a> <a href="#ref-for-dom-permissiondescriptor-name-4" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-name-5" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-name-6" title="§ 4.3 Prompt the user to choose">§ 4.3 Prompt the user to choose</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-name-7" title="§ 5.2.1 query() method">§ 5.2.1 query() method</a> <a href="#ref-for-dom-permissiondescriptor-name-8" title="Reference 2">(2)</a> <a href="#ref-for-dom-permissiondescriptor-name-9" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-name-10" title="§ 5.3.1 Creating instances">§ 5.3.1 Creating instances</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-name-11" title="§ 5.3.4 onchange attribute">§ 5.3.4 onchange attribute</a> 
  </li><li>
    <a href="#ref-for-dom-permissiondescriptor-name-12" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissions-query" aria-label="Links in this document to definition: query()">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissions-query" aria-label="Permalink for definition: query(). Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-285612776">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissions-query-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dom-permissions-query-2" title="§ 5.2 Permissions interface">§ 5.2 Permissions interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissions-query-3" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-query-a-permission" aria-label="Links in this document to definition: query a permission">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-query-a-permission" aria-label="Permalink for definition: query a permission. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionstatus" aria-label="Links in this document to definition: PermissionStatus">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionstatus" aria-label="Permalink for definition: PermissionStatus. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionstatus-1" title="§ 2.2.1 Aspects">§ 2.2.1 Aspects</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-2" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dom-permissionstatus-3" title="Reference 2">(2)</a> <a href="#ref-for-dom-permissionstatus-4" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-5" title="§ 5.2 Permissions interface">§ 5.2 Permissions interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-6" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-7" title="§ 5.3.4 onchange attribute">§ 5.3.4 onchange attribute</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-8" title="§ 5.3.5 Garbage collection">§ 5.3.5 Garbage collection</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-9" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionstate" aria-label="Links in this document to definition: PermissionState">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionstate" aria-label="Permalink for definition: PermissionState. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionstate-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dom-permissionstate-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-3" title="§ 4.1 Reading the current permission state">§ 4.1 Reading the current permission state</a> <a href="#ref-for-dom-permissionstate-4" title="Reference 2">(2)</a> <a href="#ref-for-dom-permissionstate-5" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-6" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-7" title="§ B. Automated testing">§ B. Automated testing</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-8" title="§ E. IDL Index">§ E. IDL Index</a> <a href="#ref-for-dom-permissionstate-9" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-query" aria-label="Links in this document to definition: [[query]]">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-query" aria-label="Permalink for definition: [[query]]. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-query-1" title="§ 5.2.1 query() method">§ 5.2.1 query() method</a> 
  </li><li>
    <a href="#ref-for-dfn-query-2" title="§ 5.3.1 Creating instances">§ 5.3.1 Creating instances</a> 
  </li><li>
    <a href="#ref-for-dfn-query-3" title="§ 5.3.4 onchange attribute">§ 5.3.4 onchange attribute</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionstate-granted" aria-label="Links in this document to definition: granted">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionstate-granted" aria-label="Permalink for definition: granted. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1212188233">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionstate-granted-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dom-permissionstate-granted-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-granted-3" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> <a href="#ref-for-dom-permissionstate-granted-4" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-granted-5" title="§ 4.3 Prompt the user to choose">§ 4.3 Prompt the user to choose</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-granted-6" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-granted-7" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionstate-denied" aria-label="Links in this document to definition: denied">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionstate-denied" aria-label="Permalink for definition: denied. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1212188233">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionstate-denied-1" title="§ 2.2.1 Aspects">§ 2.2.1 Aspects</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-denied-2" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> <a href="#ref-for-dom-permissionstate-denied-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-denied-4" title="§ 4.1 Reading the current permission state">§ 4.1 Reading the current permission state</a> <a href="#ref-for-dom-permissionstate-denied-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-denied-6" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> <a href="#ref-for-dom-permissionstate-denied-7" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-denied-8" title="§ 4.3 Prompt the user to choose">§ 4.3 Prompt the user to choose</a> <a href="#ref-for-dom-permissionstate-denied-9" title="Reference 2">(2)</a> <a href="#ref-for-dom-permissionstate-denied-10" title="Reference 3">(3)</a> <a href="#ref-for-dom-permissionstate-denied-11" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-denied-12" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-denied-13" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-denied-14" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionstate-prompt" aria-label="Links in this document to definition: prompt">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionstate-prompt" aria-label="Permalink for definition: prompt. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1212188233">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionstate-prompt-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-prompt-2" title="§ 4.2 Requesting permission to use a powerful feature">§ 4.2 Requesting permission to use a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-prompt-3" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstate-prompt-4" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-create-a-permissionstatus" aria-label="Links in this document to definition: create a PermissionStatus">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-create-a-permissionstatus" aria-label="Permalink for definition: create a PermissionStatus. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-create-a-permissionstatus-1" title="§ 5.2.1 query() method">§ 5.2.1 query() method</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionstatus-name" aria-label="Links in this document to definition: name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionstatus-name" aria-label="Permalink for definition: name. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1212188233">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionstatus-name-1" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-name-2" title="§ 5.3.1 Creating instances">§ 5.3.1 Creating instances</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-name-3" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionstatus-state" aria-label="Links in this document to definition: state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionstatus-state" aria-label="Permalink for definition: state. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1212188233">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionstatus-state-1" title="§ 2.2.1 Aspects">§ 2.2.1 Aspects</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-state-2" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-state-3" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionstatus-onchange" aria-label="Links in this document to definition: onchange">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionstatus-onchange" aria-label="Permalink for definition: onchange. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> <a class="marker idl-block" title="Jump to IDL declaration" href="#webidl-1212188233">IDL</a>
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionstatus-onchange-1" title="§ 5.3 PermissionStatus interface">§ 5.3 PermissionStatus interface</a> 
  </li><li>
    <a href="#ref-for-dom-permissionstatus-onchange-2" title="§ E. IDL Index">§ E. IDL Index</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permissionstatus-update-steps" aria-label="Links in this document to definition: PermissionStatus update steps">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permissionstatus-update-steps" aria-label="Permalink for definition: PermissionStatus update steps. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-permissionstatus-update-steps-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-permissions-task-source" aria-label="Links in this document to definition: permissions task source">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-permissions-task-source" aria-label="Permalink for definition: permissions task source. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-permissions-task-source-1" title="§ 3. Specifying a powerful feature">§ 3. Specifying a powerful feature</a> 
  </li><li>
    <a href="#ref-for-dfn-permissions-task-source-2" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionsetparameters" aria-label="Links in this document to definition: PermissionSetParameters">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionsetparameters" aria-label="Permalink for definition: PermissionSetParameters. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionsetparameters-1" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionsetparameters-descriptor" aria-label="Links in this document to definition: descriptor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionsetparameters-descriptor" aria-label="Permalink for definition: descriptor. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionsetparameters-descriptor-1" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionsetparameters-state" aria-label="Links in this document to definition: state">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionsetparameters-state" aria-label="Permalink for definition: state. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionsetparameters-state-1" title="§ B.1 Set Permission">§ B.1 Set Permission</a> <a href="#ref-for-dom-permissionsetparameters-state-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dom-permissionsetparameters-onerealm" aria-label="Links in this document to definition: oneRealm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dom-permissionsetparameters-onerealm" aria-label="Permalink for definition: oneRealm. Activate to close this dialog.">Permalink</a>
        <span class="marker dfn-exported" title="Definition can be referenced by other specifications">exported</span> 
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dom-permissionsetparameters-onerealm-1" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-set-permission" aria-label="Links in this document to definition: Set Permission">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-set-permission" aria-label="Permalink for definition: Set Permission. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-set-permission-1" title="§ B.1 Set Permission">§ B.1 Set Permission</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>